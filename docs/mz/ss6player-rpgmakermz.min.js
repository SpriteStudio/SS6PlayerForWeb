/**
 * -----------------------------------------------------------
 * SS6Player For RPG Maker MZ v0.8.1
 *
 * Copyright(C) CRI Middleware Co., Ltd.
 * https://www.webtech.co.jp/
 * -----------------------------------------------------------
 */

// eslint-disable-next-line
var Imported = Imported || {};
Imported.SS6PlayerRPGMakerMZ = true;

/*:ja
 * @target MZ
 * @plugindesc SpriteStudio 7.0 & 6 アニメーション再生プラグイン
 * @version 0.8.1
 * @author CRI Middleware Co., Ltd.
 * @url https://github.com/SpriteStudio/SS6PlayerForWeb/tree/master/packages/ss6player-rpgmakermz
 * @help SS6Player for RPG Maker MZ
 *
 * 詳しい使い方は、GitHub リポジトリの README.md をお読みください。
 * https://github.com/SpriteStudio/SS6PlayerForWeb/tree/master/packages/ss6player-rpgmakermz/README.md
 *
 * デプロイメント時に「未使用ファイルを削除」オプションを使用した場合、
 * アニメーションを含むフォルダは削除されてしまいます。
 * 必ず、デプロイメント後にプラグインパラメータで指定したディレクトリを、
 * 出力先の同じ位置にコピーしてください。
 *
 * @param animationDir
 * @text ssfb アニメーションベースディレクトリ
 * @desc ssfb のフォルダを格納するベースディレクトリのパスです。
 * @type file
 * @default img/ssfb
 * @requiredAssets img/ssfb
 *
 * @param replaceSVActorSpriteFlag
 * @text SV アクター置き換え
 * @desc SV アクターを Sprite Studio アニメーションに置き換える機能の ON/OFF です。
 * @type boolean
 * @default false
 *
 * @param svActorDir
 * @text SV アクターディレクトリ
 * @desc SV アクターの SpriteStudio データを格納するディレクトリのパスです
 * @type file
 * @default img/ssfb/sv_actors
 * @requiredAssets img/ssfb/sv_actors
 *
 * @param svActorAnimationPack
 * @text SV アクターアニメーションパック名
 * @desc SV アクターが利用する Sprite Studio の共通アニメーションパック(ssae)名です
 * @type string
 * @default motions
 *
 * @param svActorHideWeaponGraphics
 * @text SV アクター武器非表示
 * @desc SV アクターの攻撃中の武器アニメーションを非表示にする機能の ON/OFF です。
 * @type boolean
 * @default true
 *
 * @param replaceSVEnemySpriteFlag
 * @text SV エネミー置き換え
 * @desc SV エネミーを Sprite Studio アニメーションに置き換える機能の ON/OFF です。
 * @type boolean
 * @default false
 *
 * @param svEnemyDir
 * @text SV エネミーディレクトリ
 * @desc SV アクターの SpriteStudio データを格納するディレクトリのパスです
 * @type file
 * @default img/ssfb/sv_enemies
 * @requiredAssets img/ssfb/sv_enemies
 *
 * @param svEnemyAnimationPack
 * @text SV エネミーアニメーションパック名
 * @desc SV エネミーが利用する Sprite Studio の共通アニメーションパック(ssae)名です
 * @type string
 * @default motions
 *
 * @param svEnemyAnimationName
 * @text SV エネミーアニメーション名
 * @desc SV エネミーが利用する Sprite Studio の共通アニメーション名です。
 * @type string
 * @default walk
 *
 *
 * @command loadSsfb
 * @text ssfbロード
 * @desc ssfb ファイルと関連画像をダウンロードしロードします。
 *
 * @arg ssfbId
 * @text ssfb ID
 * @desc 登録する ssfb ID です。他のコマンドから参照するのに利用します。
 * @type number
 * @min 1
 *
 * @arg ssfbFile
 * @text ssfbファイルパス
 * @desc ssfb ファイルをアニメーションディレクトリからの相対パスで指定してください。 (e.g. MeshBone/Knight.ssfb)
 * @type string
 *
 *
 * @command setAsPicture
 * @text アニメーションピクチャの設定
 * @desc ピクチャとして表示するアニメーションを設定します。
 *       この後、画像を指定せずに「ピクチャの表示」を実行してください。
 *
 * @arg ssfbId
 * @text ssfb ID
 * @desc 利用する ssfb ID を指定してください。
 * @type number
 * @min 1
 *
 * @arg animePackName
 * @text アニメパック名
 * @desc 再生するアニメパック名(ssae)を指定してください。
 *       e.g. Knight_bomb
 * @type string
 *
 * @arg animeName
 * @text アニメ名
 * @desc 再生するアニメ名を指定してください。
 *       e.g. Balloon
 * @type string
 *
 * @arg scaleX
 * @text スケールX
 * @desc X のスケールを指定します
 * @type decimals
 * @default 1.0
 *
 * @arg scaleY
 * @text スケールY
 * @desc Y のスケールを指定します
 * @type decimals
 * @default 1.0
 *
 * @arg loop
 * @text 再生ループ回数
 * @desc 再生ループ回数を指定します。 -1 を指定すると無限ループで再生します。
 * @type number
 * @default 1
 * @min -1
 *
 *
 * @command waitForPicture
 * @text ピクチャ再生待ち
 * @desc アニメーションが再生完了するまでウエイトします。ピクチャにアニメーションがない場合とループ再生時は無視されます。
 *
 * @arg pictureId
 * @text Picture ID
 * @desc アニメーション再生中のピクチャの ID を指定してください。
 * @type number
 * @min 1
 *
 */

var Imported=Imported||{};Imported.SS6PlayerRPGMakerMZ=!0,function(Dt,Ct,Lt,mt,xt,w){"use strict";class Ht{}const dt=4,ft=4,P=4,tt=new Int32Array(2),Nt=new Float32Array(tt.buffer),wt=new Float64Array(tt.buffer),_t=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var St;(function(i){i[i.UTF8_BYTES=1]="UTF8_BYTES",i[i.UTF16_STRING=2]="UTF16_STRING"})(St||(St={}));class yt{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new yt(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return tt[0]=this.readInt32(t),Nt[0]}readFloat64(t){return tt[_t?0:1]=this.readInt32(t),tt[_t?1:0]=this.readInt32(t+4),wt[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){Nt[0]=e,this.writeInt32(t,tt[0])}writeFloat64(t,e){wt[0]=e,this.writeInt32(t,tt[_t?0:1]),this.writeInt32(t+4,tt[_t?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+dt+ft)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<ft;e++)t+=String.fromCharCode(this.readInt8(this.position_+dt+e));return t}__offset(t,e){const s=t-this.readInt32(t);return e<this.readInt16(s)?this.readInt16(s+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const s=this.readInt32(t);t+=dt;const a=this.bytes_.subarray(t,t+s);return e===St.UTF8_BYTES?a:this.text_decoder_.decode(a)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+dt}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=ft)throw new Error("FlatBuffers: file identifier must be length "+ft);for(let e=0;e<ft;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+dt+e))return!1;return!0}createScalarList(t,e){const s=[];for(let a=0;a<e;++a){const c=t(a);c!==null&&s.push(c)}return s}createObjList(t,e){const s=[];for(let a=0;a<e;++a){const c=t(a);c!==null&&s.push(c.unpack())}return s}}class _{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAnimationInitialData(t,e){return(e||new _).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAnimationInitialData(t,e){return t.setPosition(t.position()+P),(e||new _).__init(t.readInt32(t.position())+t.position(),t)}index(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}lowflag(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}highflag(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):0}priority(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}cellIndex(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}opacity(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}localopacity(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt16(this.bb_pos+t):0}masklimen(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readInt16(this.bb_pos+t):0}positionX(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb_pos+t):0}positionY(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readFloat32(this.bb_pos+t):0}positionZ(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readFloat32(this.bb_pos+t):0}pivotX(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readFloat32(this.bb_pos+t):0}pivotY(){const t=this.bb.__offset(this.bb_pos,28);return t?this.bb.readFloat32(this.bb_pos+t):0}rotationX(){const t=this.bb.__offset(this.bb_pos,30);return t?this.bb.readFloat32(this.bb_pos+t):0}rotationY(){const t=this.bb.__offset(this.bb_pos,32);return t?this.bb.readFloat32(this.bb_pos+t):0}rotationZ(){const t=this.bb.__offset(this.bb_pos,34);return t?this.bb.readFloat32(this.bb_pos+t):0}scaleX(){const t=this.bb.__offset(this.bb_pos,36);return t?this.bb.readFloat32(this.bb_pos+t):0}scaleY(){const t=this.bb.__offset(this.bb_pos,38);return t?this.bb.readFloat32(this.bb_pos+t):0}localscaleX(){const t=this.bb.__offset(this.bb_pos,40);return t?this.bb.readFloat32(this.bb_pos+t):0}localscaleY(){const t=this.bb.__offset(this.bb_pos,42);return t?this.bb.readFloat32(this.bb_pos+t):0}sizeX(){const t=this.bb.__offset(this.bb_pos,44);return t?this.bb.readFloat32(this.bb_pos+t):0}sizeY(){const t=this.bb.__offset(this.bb_pos,46);return t?this.bb.readFloat32(this.bb_pos+t):0}uvMoveX(){const t=this.bb.__offset(this.bb_pos,48);return t?this.bb.readFloat32(this.bb_pos+t):0}uvMoveY(){const t=this.bb.__offset(this.bb_pos,50);return t?this.bb.readFloat32(this.bb_pos+t):0}uvRotation(){const t=this.bb.__offset(this.bb_pos,52);return t?this.bb.readFloat32(this.bb_pos+t):0}uvScaleX(){const t=this.bb.__offset(this.bb_pos,54);return t?this.bb.readFloat32(this.bb_pos+t):0}uvScaleY(){const t=this.bb.__offset(this.bb_pos,56);return t?this.bb.readFloat32(this.bb_pos+t):0}boundingRadius(){const t=this.bb.__offset(this.bb_pos,58);return t?this.bb.readFloat32(this.bb_pos+t):0}instanceValueCurKeyframe(){const t=this.bb.__offset(this.bb_pos,60);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueStartFrame(){const t=this.bb.__offset(this.bb_pos,62);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueEndFrame(){const t=this.bb.__offset(this.bb_pos,64);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueLoopNum(){const t=this.bb.__offset(this.bb_pos,66);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueSpeed(){const t=this.bb.__offset(this.bb_pos,68);return t?this.bb.readFloat32(this.bb_pos+t):0}instanceValueLoopflag(){const t=this.bb.__offset(this.bb_pos,70);return t?this.bb.readInt32(this.bb_pos+t):0}effectValueCurKeyframe(){const t=this.bb.__offset(this.bb_pos,72);return t?this.bb.readInt32(this.bb_pos+t):0}effectValueStartTime(){const t=this.bb.__offset(this.bb_pos,74);return t?this.bb.readInt32(this.bb_pos+t):0}effectValueSpeed(){const t=this.bb.__offset(this.bb_pos,76);return t?this.bb.readFloat32(this.bb_pos+t):0}effectValueLoopflag(){const t=this.bb.__offset(this.bb_pos,78);return t?this.bb.readInt32(this.bb_pos+t):0}static startAnimationInitialData(t){t.startObject(38)}static addIndex(t,e){t.addFieldInt16(0,e,0)}static addLowflag(t,e){t.addFieldInt32(1,e,0)}static addHighflag(t,e){t.addFieldInt32(2,e,0)}static addPriority(t,e){t.addFieldInt16(3,e,0)}static addCellIndex(t,e){t.addFieldInt16(4,e,0)}static addOpacity(t,e){t.addFieldInt16(5,e,0)}static addLocalopacity(t,e){t.addFieldInt16(6,e,0)}static addMasklimen(t,e){t.addFieldInt16(7,e,0)}static addPositionX(t,e){t.addFieldFloat32(8,e,0)}static addPositionY(t,e){t.addFieldFloat32(9,e,0)}static addPositionZ(t,e){t.addFieldFloat32(10,e,0)}static addPivotX(t,e){t.addFieldFloat32(11,e,0)}static addPivotY(t,e){t.addFieldFloat32(12,e,0)}static addRotationX(t,e){t.addFieldFloat32(13,e,0)}static addRotationY(t,e){t.addFieldFloat32(14,e,0)}static addRotationZ(t,e){t.addFieldFloat32(15,e,0)}static addScaleX(t,e){t.addFieldFloat32(16,e,0)}static addScaleY(t,e){t.addFieldFloat32(17,e,0)}static addLocalscaleX(t,e){t.addFieldFloat32(18,e,0)}static addLocalscaleY(t,e){t.addFieldFloat32(19,e,0)}static addSizeX(t,e){t.addFieldFloat32(20,e,0)}static addSizeY(t,e){t.addFieldFloat32(21,e,0)}static addUvMoveX(t,e){t.addFieldFloat32(22,e,0)}static addUvMoveY(t,e){t.addFieldFloat32(23,e,0)}static addUvRotation(t,e){t.addFieldFloat32(24,e,0)}static addUvScaleX(t,e){t.addFieldFloat32(25,e,0)}static addUvScaleY(t,e){t.addFieldFloat32(26,e,0)}static addBoundingRadius(t,e){t.addFieldFloat32(27,e,0)}static addInstanceValueCurKeyframe(t,e){t.addFieldInt32(28,e,0)}static addInstanceValueStartFrame(t,e){t.addFieldInt32(29,e,0)}static addInstanceValueEndFrame(t,e){t.addFieldInt32(30,e,0)}static addInstanceValueLoopNum(t,e){t.addFieldInt32(31,e,0)}static addInstanceValueSpeed(t,e){t.addFieldFloat32(32,e,0)}static addInstanceValueLoopflag(t,e){t.addFieldInt32(33,e,0)}static addEffectValueCurKeyframe(t,e){t.addFieldInt32(34,e,0)}static addEffectValueStartTime(t,e){t.addFieldInt32(35,e,0)}static addEffectValueSpeed(t,e){t.addFieldFloat32(36,e,0)}static addEffectValueLoopflag(t,e){t.addFieldInt32(37,e,0)}static endAnimationInitialData(t){return t.endObject()}static createAnimationInitialData(t,e,s,a,c,n,h,r,o,l,d,u,p,m,f,I,F,Z,q,g,M,A,U,L,x,X,B,T,N,Q,j,z,K,H,it,at,ge,Fe,ve){return _.startAnimationInitialData(t),_.addIndex(t,e),_.addLowflag(t,s),_.addHighflag(t,a),_.addPriority(t,c),_.addCellIndex(t,n),_.addOpacity(t,h),_.addLocalopacity(t,r),_.addMasklimen(t,o),_.addPositionX(t,l),_.addPositionY(t,d),_.addPositionZ(t,u),_.addPivotX(t,p),_.addPivotY(t,m),_.addRotationX(t,f),_.addRotationY(t,I),_.addRotationZ(t,F),_.addScaleX(t,Z),_.addScaleY(t,q),_.addLocalscaleX(t,g),_.addLocalscaleY(t,M),_.addSizeX(t,A),_.addSizeY(t,U),_.addUvMoveX(t,L),_.addUvMoveY(t,x),_.addUvRotation(t,X),_.addUvScaleX(t,B),_.addUvScaleY(t,T),_.addBoundingRadius(t,N),_.addInstanceValueCurKeyframe(t,Q),_.addInstanceValueStartFrame(t,j),_.addInstanceValueEndFrame(t,z),_.addInstanceValueLoopNum(t,K),_.addInstanceValueSpeed(t,H),_.addInstanceValueLoopflag(t,it),_.addEffectValueCurKeyframe(t,at),_.addEffectValueStartTime(t,ge),_.addEffectValueSpeed(t,Fe),_.addEffectValueLoopflag(t,ve),_.endAnimationInitialData(t)}}class R{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAspartState(t,e){return(e||new R).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAspartState(t,e){return t.setPosition(t.position()+P),(e||new R).__init(t.readInt32(t.position())+t.position(),t)}index(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}flag1(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint32(this.bb_pos+t):0}flag2(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint32(this.bb_pos+t):0}data(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}dataLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}dataArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startpartState(t){t.startObject(4)}static addIndex(t,e){t.addFieldInt16(0,e,0)}static addFlag1(t,e){t.addFieldInt32(1,e,0)}static addFlag2(t,e){t.addFieldInt32(2,e,0)}static addData(t,e){t.addFieldOffset(3,e,0)}static createDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addInt32(e[s]);return t.endVector()}static startDataVector(t,e){t.startVector(4,e,4)}static endpartState(t){return t.endObject()}static createpartState(t,e,s,a,c){return R.startpartState(t),R.addIndex(t,e),R.addFlag1(t,s),R.addFlag2(t,a),R.addData(t,c),R.endpartState(t)}}class nt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsframeDataIndex(t,e){return(e||new nt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsframeDataIndex(t,e){return t.setPosition(t.position()+P),(e||new nt).__init(t.readInt32(t.position())+t.position(),t)}states(t,e){const s=this.bb.__offset(this.bb_pos,4);return s?(e||new R).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}statesLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}static startframeDataIndex(t){t.startObject(1)}static addStates(t,e){t.addFieldOffset(0,e,0)}static createStatesVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startStatesVector(t,e){t.startVector(4,e,4)}static endframeDataIndex(t){return t.endObject()}static createframeDataIndex(t,e){return nt.startframeDataIndex(t),nt.addStates(t,e),nt.endframeDataIndex(t)}}class et{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAslabelDataItem(t,e){return(e||new et).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAslabelDataItem(t,e){return t.setPosition(t.position()+P),(e||new et).__init(t.readInt32(t.position())+t.position(),t)}label(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}frameIndex(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}static startlabelDataItem(t){t.startObject(2)}static addLabel(t,e){t.addFieldOffset(0,e,0)}static addFrameIndex(t,e){t.addFieldInt16(1,e,0)}static endlabelDataItem(t){return t.endObject()}static createlabelDataItem(t,e,s){return et.startlabelDataItem(t),et.addLabel(t,e),et.addFrameIndex(t,s),et.endlabelDataItem(t)}}class ot{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsmeshDataIndices(t,e){return(e||new ot).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsmeshDataIndices(t,e){return t.setPosition(t.position()+P),(e||new ot).__init(t.readInt32(t.position())+t.position(),t)}indices(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}indicesLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}indicesArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startmeshDataIndices(t){t.startObject(1)}static addIndices(t,e){t.addFieldOffset(0,e,0)}static createIndicesVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addFloat32(e[s]);return t.endVector()}static startIndicesVector(t,e){t.startVector(4,e,4)}static endmeshDataIndices(t){return t.endObject()}static createmeshDataIndices(t,e){return ot.startmeshDataIndices(t),ot.addIndices(t,e),ot.endmeshDataIndices(t)}}class rt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsmeshDataUV(t,e){return(e||new rt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsmeshDataUV(t,e){return t.setPosition(t.position()+P),(e||new rt).__init(t.readInt32(t.position())+t.position(),t)}uv(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}uvLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}uvArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startmeshDataUV(t){t.startObject(1)}static addUv(t,e){t.addFieldOffset(0,e,0)}static createUvVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addFloat32(e[s]);return t.endVector()}static startUvVector(t,e){t.startVector(4,e,4)}static endmeshDataUV(t){return t.endObject()}static createmeshDataUV(t,e){return rt.startmeshDataUV(t),rt.addUv(t,e),rt.endmeshDataUV(t)}}class W{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsuserDataItem(t,e){return(e||new W).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsuserDataItem(t,e){return t.setPosition(t.position()+P),(e||new W).__init(t.readInt32(t.position())+t.position(),t)}flags(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}arrayIndex(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}dataType(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}dataTypeLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}dataTypeArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}data(t,e){const s=this.bb.__offset(this.bb_pos,10);return s?this.bb.__union(e,this.bb.__vector(this.bb_pos+s)+t*4):null}dataLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startuserDataItem(t){t.startObject(4)}static addFlags(t,e){t.addFieldInt16(0,e,0)}static addArrayIndex(t,e){t.addFieldInt16(1,e,0)}static addDataType(t,e){t.addFieldOffset(2,e,0)}static createDataTypeVector(t,e){t.startVector(1,e.length,1);for(let s=e.length-1;s>=0;s--)t.addInt8(e[s]);return t.endVector()}static startDataTypeVector(t,e){t.startVector(1,e,1)}static addData(t,e){t.addFieldOffset(3,e,0)}static createDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startDataVector(t,e){t.startVector(4,e,4)}static enduserDataItem(t){return t.endObject()}static createuserDataItem(t,e,s,a,c){return W.startuserDataItem(t),W.addFlags(t,e),W.addArrayIndex(t,s),W.addDataType(t,a),W.addData(t,c),W.enduserDataItem(t)}}class st{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsuserDataPerFrame(t,e){return(e||new st).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsuserDataPerFrame(t,e){return t.setPosition(t.position()+P),(e||new st).__init(t.readInt32(t.position())+t.position(),t)}frameIndex(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}data(t,e){const s=this.bb.__offset(this.bb_pos,6);return s?(e||new W).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}dataLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}static startuserDataPerFrame(t){t.startObject(2)}static addFrameIndex(t,e){t.addFieldInt16(0,e,0)}static addData(t,e){t.addFieldOffset(1,e,0)}static createDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startDataVector(t,e){t.startVector(4,e,4)}static enduserDataPerFrame(t){return t.endObject()}static createuserDataPerFrame(t,e,s){return st.startuserDataPerFrame(t),st.addFrameIndex(t,e),st.addData(t,s),st.enduserDataPerFrame(t)}}class S{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAnimationData(t,e){return(e||new S).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAnimationData(t,e){return t.setPosition(t.position()+P),(e||new S).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}defaultData(t,e){const s=this.bb.__offset(this.bb_pos,6);return s?(e||new _).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}defaultDataLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}frameData(t,e){const s=this.bb.__offset(this.bb_pos,8);return s?(e||new nt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}frameDataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}userData(t,e){const s=this.bb.__offset(this.bb_pos,10);return s?(e||new st).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}userDataLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}labelData(t,e){const s=this.bb.__offset(this.bb_pos,12);return s?(e||new et).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}labelDataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}meshsDataUv(t,e){const s=this.bb.__offset(this.bb_pos,14);return s?(e||new rt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}meshsDataUvLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}meshsDataIndices(t,e){const s=this.bb.__offset(this.bb_pos,16);return s?(e||new ot).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}meshsDataIndicesLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}startFrames(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readInt16(this.bb_pos+t):0}endFrames(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readInt16(this.bb_pos+t):0}totalFrames(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt16(this.bb_pos+t):0}fps(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readInt16(this.bb_pos+t):0}labelNum(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt16(this.bb_pos+t):0}canvasSizeW(){const t=this.bb.__offset(this.bb_pos,28);return t?this.bb.readInt16(this.bb_pos+t):0}canvasSizeH(){const t=this.bb.__offset(this.bb_pos,30);return t?this.bb.readInt16(this.bb_pos+t):0}canvasPvotX(){const t=this.bb.__offset(this.bb_pos,32);return t?this.bb.readFloat32(this.bb_pos+t):0}canvasPvotY(){const t=this.bb.__offset(this.bb_pos,34);return t?this.bb.readFloat32(this.bb_pos+t):0}static startAnimationData(t){t.startObject(16)}static addName(t,e){t.addFieldOffset(0,e,0)}static addDefaultData(t,e){t.addFieldOffset(1,e,0)}static createDefaultDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startDefaultDataVector(t,e){t.startVector(4,e,4)}static addFrameData(t,e){t.addFieldOffset(2,e,0)}static createFrameDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startFrameDataVector(t,e){t.startVector(4,e,4)}static addUserData(t,e){t.addFieldOffset(3,e,0)}static createUserDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startUserDataVector(t,e){t.startVector(4,e,4)}static addLabelData(t,e){t.addFieldOffset(4,e,0)}static createLabelDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startLabelDataVector(t,e){t.startVector(4,e,4)}static addMeshsDataUv(t,e){t.addFieldOffset(5,e,0)}static createMeshsDataUvVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startMeshsDataUvVector(t,e){t.startVector(4,e,4)}static addMeshsDataIndices(t,e){t.addFieldOffset(6,e,0)}static createMeshsDataIndicesVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startMeshsDataIndicesVector(t,e){t.startVector(4,e,4)}static addStartFrames(t,e){t.addFieldInt16(7,e,0)}static addEndFrames(t,e){t.addFieldInt16(8,e,0)}static addTotalFrames(t,e){t.addFieldInt16(9,e,0)}static addFps(t,e){t.addFieldInt16(10,e,0)}static addLabelNum(t,e){t.addFieldInt16(11,e,0)}static addCanvasSizeW(t,e){t.addFieldInt16(12,e,0)}static addCanvasSizeH(t,e){t.addFieldInt16(13,e,0)}static addCanvasPvotX(t,e){t.addFieldFloat32(14,e,0)}static addCanvasPvotY(t,e){t.addFieldFloat32(15,e,0)}static endAnimationData(t){return t.endObject()}static createAnimationData(t,e,s,a,c,n,h,r,o,l,d,u,p,m,f,I,F){return S.startAnimationData(t),S.addName(t,e),S.addDefaultData(t,s),S.addFrameData(t,a),S.addUserData(t,c),S.addLabelData(t,n),S.addMeshsDataUv(t,h),S.addMeshsDataIndices(t,r),S.addStartFrames(t,o),S.addEndFrames(t,l),S.addTotalFrames(t,d),S.addFps(t,u),S.addLabelNum(t,p),S.addCanvasSizeW(t,m),S.addCanvasSizeH(t,f),S.addCanvasPvotX(t,I),S.addCanvasPvotY(t,F),S.endAnimationData(t)}}var v=(i=>(i[i.Invalid=-1]="Invalid",i[i.Nulltype=0]="Nulltype",i[i.Normal=1]="Normal",i[i.Text=2]="Text",i[i.Instance=3]="Instance",i[i.Armature=4]="Armature",i[i.Effect=5]="Effect",i[i.Mesh=6]="Mesh",i[i.Movenode=7]="Movenode",i[i.Constraint=8]="Constraint",i[i.Mask=9]="Mask",i[i.Joint=10]="Joint",i[i.Bonepoint=11]="Bonepoint",i))(v||{});class O{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsPartData(t,e){return(e||new O).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsPartData(t,e){return t.setPosition(t.position()+P),(e||new O).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}index(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}parentIndex(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt8(this.bb_pos+t):v.Nulltype}boundsType(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}alphaBlendType(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}refname(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__string(this.bb_pos+e,t):null}effectfilename(t){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__string(this.bb_pos+e,t):null}colorLabel(t){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__string(this.bb_pos+e,t):null}maskInfluence(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt16(this.bb_pos+t):0}static startPartData(t){t.startObject(10)}static addName(t,e){t.addFieldOffset(0,e,0)}static addIndex(t,e){t.addFieldInt16(1,e,0)}static addParentIndex(t,e){t.addFieldInt16(2,e,0)}static addType(t,e){t.addFieldInt8(3,e,v.Nulltype)}static addBoundsType(t,e){t.addFieldInt16(4,e,0)}static addAlphaBlendType(t,e){t.addFieldInt16(5,e,0)}static addRefname(t,e){t.addFieldOffset(6,e,0)}static addEffectfilename(t,e){t.addFieldOffset(7,e,0)}static addColorLabel(t,e){t.addFieldOffset(8,e,0)}static addMaskInfluence(t,e){t.addFieldInt16(9,e,0)}static endPartData(t){return t.endObject()}static createPartData(t,e,s,a,c,n,h,r,o,l,d){return O.startPartData(t),O.addName(t,e),O.addIndex(t,s),O.addParentIndex(t,a),O.addType(t,c),O.addBoundsType(t,n),O.addAlphaBlendType(t,h),O.addRefname(t,r),O.addEffectfilename(t,o),O.addColorLabel(t,l),O.addMaskInfluence(t,d),O.endPartData(t)}}class ${constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAnimePackData(t,e){return(e||new $).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAnimePackData(t,e){return t.setPosition(t.position()+P),(e||new $).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}parts(t,e){const s=this.bb.__offset(this.bb_pos,6);return s?(e||new O).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}partsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}animations(t,e){const s=this.bb.__offset(this.bb_pos,8);return s?(e||new S).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}animationsLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startAnimePackData(t){t.startObject(3)}static addName(t,e){t.addFieldOffset(0,e,0)}static addParts(t,e){t.addFieldOffset(1,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static addAnimations(t,e){t.addFieldOffset(2,e,0)}static createAnimationsVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startAnimationsVector(t,e){t.startVector(4,e,4)}static endAnimePackData(t){return t.endObject()}static createAnimePackData(t,e,s,a){return $.startAnimePackData(t),$.addName(t,e),$.addParts(t,s),$.addAnimations(t,a),$.endAnimePackData(t)}}class k{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCellMap(t,e){return(e||new k).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCellMap(t,e){return t.setPosition(t.position()+P),(e||new k).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}imagePath(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}index(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}wrapmode(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}filtermode(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}static startCellMap(t){t.startObject(5)}static addName(t,e){t.addFieldOffset(0,e,0)}static addImagePath(t,e){t.addFieldOffset(1,e,0)}static addIndex(t,e){t.addFieldInt16(2,e,0)}static addWrapmode(t,e){t.addFieldInt16(3,e,0)}static addFiltermode(t,e){t.addFieldInt16(4,e,0)}static endCellMap(t){return t.endObject()}static createCellMap(t,e,s,a,c,n){return k.startCellMap(t),k.addName(t,e),k.addImagePath(t,s),k.addIndex(t,a),k.addWrapmode(t,c),k.addFiltermode(t,n),k.endCellMap(t)}}class bt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCell(t,e){return(e||new bt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCell(t,e){return t.setPosition(t.position()+P),(e||new bt).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}cellMap(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new k).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}indexInCellMap(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}x(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}y(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}width(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}height(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt16(this.bb_pos+t):0}pivotX(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readFloat32(this.bb_pos+t):0}pivotY(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb_pos+t):0}u1(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readFloat32(this.bb_pos+t):0}v1(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readFloat32(this.bb_pos+t):0}u2(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readFloat32(this.bb_pos+t):0}v2(){const t=this.bb.__offset(this.bb_pos,28);return t?this.bb.readFloat32(this.bb_pos+t):0}static startCell(t){t.startObject(13)}static addName(t,e){t.addFieldOffset(0,e,0)}static addCellMap(t,e){t.addFieldOffset(1,e,0)}static addIndexInCellMap(t,e){t.addFieldInt16(2,e,0)}static addX(t,e){t.addFieldInt16(3,e,0)}static addY(t,e){t.addFieldInt16(4,e,0)}static addWidth(t,e){t.addFieldInt16(5,e,0)}static addHeight(t,e){t.addFieldInt16(6,e,0)}static addPivotX(t,e){t.addFieldFloat32(7,e,0)}static addPivotY(t,e){t.addFieldFloat32(8,e,0)}static addU1(t,e){t.addFieldFloat32(9,e,0)}static addV1(t,e){t.addFieldFloat32(10,e,0)}static addU2(t,e){t.addFieldFloat32(11,e,0)}static addV2(t,e){t.addFieldFloat32(12,e,0)}static endCell(t){return t.endObject()}}class D{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsEffectNode(t,e){return(e||new D).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsEffectNode(t,e){return t.setPosition(t.position()+P),(e||new D).__init(t.readInt32(t.position())+t.position(),t)}arrayIndex(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}parentIndex(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}cellIndex(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}blendType(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}numBehavior(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}behaviorType(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}behaviorTypeLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}behaviorTypeArray(){const t=this.bb.__offset(this.bb_pos,16);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}behavior(t,e){const s=this.bb.__offset(this.bb_pos,18);return s?this.bb.__union(e,this.bb.__vector(this.bb_pos+s)+t*4):null}behaviorLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startEffectNode(t){t.startObject(8)}static addArrayIndex(t,e){t.addFieldInt16(0,e,0)}static addParentIndex(t,e){t.addFieldInt16(1,e,0)}static addType(t,e){t.addFieldInt16(2,e,0)}static addCellIndex(t,e){t.addFieldInt16(3,e,0)}static addBlendType(t,e){t.addFieldInt16(4,e,0)}static addNumBehavior(t,e){t.addFieldInt16(5,e,0)}static addBehaviorType(t,e){t.addFieldOffset(6,e,0)}static createBehaviorTypeVector(t,e){t.startVector(1,e.length,1);for(let s=e.length-1;s>=0;s--)t.addInt8(e[s]);return t.endVector()}static startBehaviorTypeVector(t,e){t.startVector(1,e,1)}static addBehavior(t,e){t.addFieldOffset(7,e,0)}static createBehaviorVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startBehaviorVector(t,e){t.startVector(4,e,4)}static endEffectNode(t){return t.endObject()}static createEffectNode(t,e,s,a,c,n,h,r,o){return D.startEffectNode(t),D.addArrayIndex(t,e),D.addParentIndex(t,s),D.addType(t,a),D.addCellIndex(t,c),D.addBlendType(t,n),D.addNumBehavior(t,h),D.addBehaviorType(t,r),D.addBehavior(t,o),D.endEffectNode(t)}}class C{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsEffectFile(t,e){return(e||new C).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsEffectFile(t,e){return t.setPosition(t.position()+P),(e||new C).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}fps(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}isLockRandSeed(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}lockRandSeed(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}layoutScaleX(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}layoutScaleY(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}numNodeList(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt16(this.bb_pos+t):0}effectNode(t,e){const s=this.bb.__offset(this.bb_pos,18);return s?(e||new D).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}effectNodeLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startEffectFile(t){t.startObject(8)}static addName(t,e){t.addFieldOffset(0,e,0)}static addFps(t,e){t.addFieldInt16(1,e,0)}static addIsLockRandSeed(t,e){t.addFieldInt16(2,e,0)}static addLockRandSeed(t,e){t.addFieldInt16(3,e,0)}static addLayoutScaleX(t,e){t.addFieldInt16(4,e,0)}static addLayoutScaleY(t,e){t.addFieldInt16(5,e,0)}static addNumNodeList(t,e){t.addFieldInt16(6,e,0)}static addEffectNode(t,e){t.addFieldOffset(7,e,0)}static createEffectNodeVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startEffectNodeVector(t,e){t.startVector(4,e,4)}static endEffectFile(t){return t.endObject()}static createEffectFile(t,e,s,a,c,n,h,r,o){return C.startEffectFile(t),C.addName(t,e),C.addFps(t,s),C.addIsLockRandSeed(t,a),C.addLockRandSeed(t,c),C.addLayoutScaleX(t,n),C.addLayoutScaleY(t,h),C.addNumNodeList(t,r),C.addEffectNode(t,o),C.endEffectFile(t)}}var b=(i=>(i[i.INVISIBLE=1]="INVISIBLE",i[i.FLIP_H=2]="FLIP_H",i[i.FLIP_V=4]="FLIP_V",i[i.CELL_INDEX=8]="CELL_INDEX",i[i.POSITION_X=16]="POSITION_X",i[i.POSITION_Y=32]="POSITION_Y",i[i.POSITION_Z=64]="POSITION_Z",i[i.PIVOT_X=128]="PIVOT_X",i[i.PIVOT_Y=256]="PIVOT_Y",i[i.ROTATIONX=512]="ROTATIONX",i[i.ROTATIONY=1024]="ROTATIONY",i[i.ROTATIONZ=2048]="ROTATIONZ",i[i.SCALE_X=4096]="SCALE_X",i[i.SCALE_Y=8192]="SCALE_Y",i[i.LOCALSCALE_X=16384]="LOCALSCALE_X",i[i.LOCALSCALE_Y=32768]="LOCALSCALE_Y",i[i.OPACITY=65536]="OPACITY",i[i.LOCALOPACITY=131072]="LOCALOPACITY",i[i.PARTS_COLOR=262144]="PARTS_COLOR",i[i.VERTEX_TRANSFORM=524288]="VERTEX_TRANSFORM",i[i.SIZE_X=1048576]="SIZE_X",i[i.SIZE_Y=2097152]="SIZE_Y",i[i.U_MOVE=4194304]="U_MOVE",i[i.V_MOVE=8388608]="V_MOVE",i[i.UV_ROTATION=16777216]="UV_ROTATION",i[i.U_SCALE=33554432]="U_SCALE",i[i.V_SCALE=67108864]="V_SCALE",i[i.BOUNDINGRADIUS=134217728]="BOUNDINGRADIUS",i[i.MASK=268435456]="MASK",i[i.PRIORITY=536870912]="PRIORITY",i[i.INSTANCE_KEYFRAME=1073741824]="INSTANCE_KEYFRAME",i[i.EFFECT_KEYFRAME=2147483648]="EFFECT_KEYFRAME",i))(b||{}),At=(i=>(i[i.MESHDATA=1]="MESHDATA",i))(At||{});class V{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsProjectData(t,e){return(e||new V).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsProjectData(t,e){return t.setPosition(t.position()+P),(e||new V).__init(t.readInt32(t.position())+t.position(),t)}static bufferHasIdentifier(t){return t.__has_identifier("SSFB")}dataId(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb_pos+t):0}version(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint32(this.bb_pos+t):0}flags(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint32(this.bb_pos+t):0}imageBaseDir(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}cells(t,e){const s=this.bb.__offset(this.bb_pos,12);return s?(e||new bt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}cellsLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}animePacks(t,e){const s=this.bb.__offset(this.bb_pos,14);return s?(e||new $).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}animePacksLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}effectFileList(t,e){const s=this.bb.__offset(this.bb_pos,16);return s?(e||new C).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}effectFileListLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}numCells(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readInt16(this.bb_pos+t):0}numAnimePacks(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readInt16(this.bb_pos+t):0}numEffectFileList(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt16(this.bb_pos+t):0}static startProjectData(t){t.startObject(10)}static addDataId(t,e){t.addFieldInt32(0,e,0)}static addVersion(t,e){t.addFieldInt32(1,e,0)}static addFlags(t,e){t.addFieldInt32(2,e,0)}static addImageBaseDir(t,e){t.addFieldOffset(3,e,0)}static addCells(t,e){t.addFieldOffset(4,e,0)}static createCellsVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startCellsVector(t,e){t.startVector(4,e,4)}static addAnimePacks(t,e){t.addFieldOffset(5,e,0)}static createAnimePacksVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startAnimePacksVector(t,e){t.startVector(4,e,4)}static addEffectFileList(t,e){t.addFieldOffset(6,e,0)}static createEffectFileListVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startEffectFileListVector(t,e){t.startVector(4,e,4)}static addNumCells(t,e){t.addFieldInt16(7,e,0)}static addNumAnimePacks(t,e){t.addFieldInt16(8,e,0)}static addNumEffectFileList(t,e){t.addFieldInt16(9,e,0)}static endProjectData(t){return t.endObject()}static finishProjectDataBuffer(t,e){t.finish(e,"SSFB")}static finishSizePrefixedProjectDataBuffer(t,e){t.finish(e,"SSFB",!0)}static createProjectData(t,e,s,a,c,n,h,r,o,l,d){return V.startProjectData(t),V.addDataId(t,e),V.addVersion(t,s),V.addFlags(t,a),V.addImageBaseDir(t,c),V.addCells(t,n),V.addAnimePacks(t,h),V.addEffectFileList(t,r),V.addNumCells(t,o),V.addNumAnimePacks(t,l),V.addNumEffectFileList(t,d),V.endProjectData(t)}}class $t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}integer(){return this.bb.readInt32(this.bb_pos)}static sizeOf(){return 4}static createuserDataInteger(t,e){return t.prep(4,4),t.writeInt32(e),t.offset()}}class kt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}x(){return this.bb.readInt32(this.bb_pos)}y(){return this.bb.readInt32(this.bb_pos+4)}static sizeOf(){return 8}static createuserDataPoint(t,e,s){return t.prep(4,8),t.writeInt32(s),t.writeInt32(e),t.offset()}}class pt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}x(){return this.bb.readInt32(this.bb_pos)}y(){return this.bb.readInt32(this.bb_pos+4)}w(){return this.bb.readInt32(this.bb_pos+8)}h(){return this.bb.readInt32(this.bb_pos+12)}static sizeOf(){return 16}static createuserDataRect(t,e,s,a,c){return t.prep(4,16),t.writeInt32(c),t.writeInt32(a),t.writeInt32(s),t.writeInt32(e),t.offset()}}class J{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsuserDataString(t,e){return(e||new J).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsuserDataString(t,e){return t.setPosition(t.position()+P),(e||new J).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startuserDataString(t){t.startObject(2)}static addLength(t,e){t.addFieldInt32(0,e,0)}static addData(t,e){t.addFieldOffset(1,e,0)}static enduserDataString(t){return t.endObject()}static createuserDataString(t,e,s){return J.startuserDataString(t),J.addLength(t,e),J.addData(t,s),J.enduserDataString(t)}}let Jt=class{static getProjectData(t){const e=new yt(t);return V.getRootAsProjectData(e)}};class It{static getProjectData(t){return Jt.getProjectData(t)}}class ct{constructor(t,e=null,s=null){this.curAnimePackName=null,this.curAnimeName=null,this.curAnimation=null,this.curAnimePackData=null,this._animePackIdx=-1,this._parentIndex=[],this._prio2index=[],this.userData=[],this.frameDataCache=null,this.currentCachedFrameNumber=-1,this.defaultFrameMap=[],this._uint32=new Uint32Array(1),this._float32=new Float32Array(this._uint32.buffer),t.hasOwnProperty("bb")?this._fbObj=t:this._fbObj=It.getProjectData(t),e!==null&&s!==null&&this.Setup(e,s)}get fbObj(){return this._fbObj}get animePackName(){return this.curAnimePackName}get animeName(){return this.curAnimeName}get animePackIdx(){return this._animePackIdx}get animePackData(){return this.curAnimePackData}get animationData(){return this.curAnimation}get parentIndex(){return this._parentIndex}get prio2index(){return this._prio2index}Setup(t,e){this.clearCaches();const s=this._fbObj.animePacksLength();let a=!1;for(let c=0;c<s;c++)if(this._fbObj.animePacks(c).name()===t){let n;const h=this._fbObj.animePacks(c).animationsLength();for(n=0;n<h;n++)if(this._fbObj.animePacks(c).animations(n).name()===e){this.curAnimePackName=t,this.curAnimeName=e,this.curAnimePackData=this._fbObj.animePacks(c),this.curAnimation=this.curAnimePackData.animations(n),a=!0;break}if(!a)continue;const r=this.curAnimation.defaultDataLength();for(let l=0;l<r;l++){const d=this.curAnimation.defaultData(l);this.defaultFrameMap[d.index()]=d}this._animePackIdx=c;const o=this.curAnimePackData.partsLength();for(this._parentIndex=new Array(o),n=0;n<o;n++){const l=this.curAnimePackData.parts(n).index();this._parentIndex[l]=this._fbObj.animePacks(c).parts(n).parentIndex()}}if(!a)throw Error("not found animePackName: "+t+" animeName: "+e)}clearCaches(){this._prio2index=[],this.userData=[],this.frameDataCache=null,this.currentCachedFrameNumber=-1,this.defaultFrameMap=[]}HaveUserData(t){if(this.userData[t]===null)return!1;if(this.userData[t]!==void 0)return!0;for(let e=0;e<this.curAnimation.userDataLength();e++)if(t===this.curAnimation.userData(e).frameIndex())return this.userData[t]=this.curAnimation.userData(e),!0;return this.userData[t]=null,!1}GetUserData(t){if(this.HaveUserData(t)===!1)return;const e=this.userData[t],s=e.dataLength();let a=0,c=[];for(let n=0;n<s;n++){const h=e.data(n).flags(),r=e.data(n).arrayIndex();let o=null,l=null,d=null,u=null,p=null,m=null,f=null,I=null,F=null;h&1&&(o=e.data(n).data(a,new $t).integer(),a++),h&2&&(l=e.data(n).data(a,new pt).x(),d=e.data(n).data(a,new pt).y(),u=e.data(n).data(a,new pt).w(),p=e.data(n).data(a,new pt).h(),a++),h&4&&(m=e.data(n).data(a,new kt).x(),f=e.data(n).data(a,new kt).y(),a++),h&8&&(I=e.data(n).data(a,new J).length(),F=e.data(n).data(a,new J).data(),a++),c.push([r,h,o,l,d,u,p,m,f,I,F])}return c}I2F(t){return this._uint32[0]=t,this._float32[0]}GetFrameData(t){if(this.currentCachedFrameNumber===t&&this.frameDataCache)return this.frameDataCache;const e=this.curAnimation.defaultDataLength();let s=new Array(e);this._prio2index=new Array(e);const a=this.curAnimation.frameData(t);for(let c=0;c<e;c++){const n=a.states(c),h=n.index();let r=n.flag1(),o=n.flag2(),l=this.GetDefaultDataByIndex(h);l.flag1=r,l.flag2=o;let d=0;if(r&b.INVISIBLE&&(l.f_hide=!0),r&b.FLIP_H&&(l.f_flipH=!0),r&b.FLIP_V&&(l.f_flipV=!0),r&b.CELL_INDEX&&(l.cellIndex=n.data(d++)),r&b.POSITION_X&&(l.positionX=this.I2F(n.data(d++))),r&b.POSITION_Y&&(l.positionY=this.I2F(n.data(d++))),r&b.POSITION_Z&&d++,r&b.PIVOT_X&&(l.pivotX=this.I2F(n.data(d++))),r&b.PIVOT_Y&&(l.pivotY=this.I2F(n.data(d++))),r&b.ROTATIONX&&d++,r&b.ROTATIONY&&d++,r&b.ROTATIONZ&&(l.rotationZ=this.I2F(n.data(d++))),r&b.SCALE_X&&(l.scaleX=this.I2F(n.data(d++))),r&b.SCALE_Y&&(l.scaleY=this.I2F(n.data(d++))),r&b.LOCALSCALE_X&&(l.localscaleX=this.I2F(n.data(d++))),r&b.LOCALSCALE_Y&&(l.localscaleY=this.I2F(n.data(d++))),r&b.OPACITY&&(l.opacity=n.data(d++)),r&b.LOCALOPACITY&&(l.localopacity=n.data(d++)),r&b.SIZE_X&&(l.size_X=this.I2F(n.data(d++))),r&b.SIZE_Y&&(l.size_Y=this.I2F(n.data(d++))),r&b.U_MOVE&&(l.uv_move_X=this.I2F(n.data(d++))),r&b.V_MOVE&&(l.uv_move_Y=this.I2F(n.data(d++))),r&b.UV_ROTATION&&(l.uv_rotation=this.I2F(n.data(d++))),r&b.U_SCALE&&(l.uv_scale_X=this.I2F(n.data(d++))),r&b.V_SCALE&&(l.uv_scale_Y=this.I2F(n.data(d++))),r&b.BOUNDINGRADIUS&&d++,r&b.MASK&&(l.masklimen=n.data(d++)),r&b.PRIORITY&&(l.priority=n.data(d++)),r&b.INSTANCE_KEYFRAME&&(l.instanceValue_curKeyframe=n.data(d++),l.instanceValue_startFrame=n.data(d++),l.instanceValue_endFrame=n.data(d++),l.instanceValue_loopNum=n.data(d++),l.instanceValue_speed=this.I2F(n.data(d++)),l.instanceValue_loopflag=n.data(d++)),r&b.EFFECT_KEYFRAME&&(l.effectValue_curKeyframe=n.data(d++),l.effectValue_startTime=n.data(d++),l.effectValue_speed=this.I2F(n.data(d++)),l.effectValue_loopflag=n.data(d++)),r&b.VERTEX_TRANSFORM){l.f_mesh=!0;const u=l.i_transformVerts=n.data(d++);u&1&&(l.u00=this.I2F(n.data(d++)),l.v00=this.I2F(n.data(d++))),u&2&&(l.u01=this.I2F(n.data(d++)),l.v01=this.I2F(n.data(d++))),u&4&&(l.u10=this.I2F(n.data(d++)),l.v10=this.I2F(n.data(d++))),u&8&&(l.u11=this.I2F(n.data(d++)),l.v11=this.I2F(n.data(d++)))}if(r&b.PARTS_COLOR){const u=n.data(d++);if(l.colorBlendType=u&255,l.useColorMatrix=l.colorBlendType!==1,u&4096){l.colorRate=this.I2F(n.data(d++));const p=n.data(d++),m=n.data(d++);l.colorArgb32=p<<16|m,l.partsColorARGB=l.colorArgb32>>>0,l.colorBlendType===1&&(l.tint=l.colorArgb32&16777215)}}if(o&At.MESHDATA){const u=this.curAnimation.meshsDataUv(h);l.meshIsBind=u.uv(0),l.meshNum=u.uv(1);let p=new Float32Array(l.meshNum*3);for(let m=0;m<l.meshNum;m++){const f=this.I2F(n.data(d++)),I=this.I2F(n.data(d++)),F=this.I2F(n.data(d++));p[m*3+0]=f,p[m*3+1]=I,p[m*3+2]=F}l.meshDataPoint=p}s[h]=l,this._prio2index[c]=h,this.curAnimePackData.parts(h).type()===0&&(s[h].cellIndex=-2)}return this.frameDataCache=s,this.currentCachedFrameNumber=t,s}GetDefaultDataByIndex(t){const e=this.defaultFrameMap[t];let s=new Ht;return s.index=e.index(),s.lowflag=e.lowflag(),s.highflag=e.highflag(),s.priority=e.priority(),s.cellIndex=e.cellIndex(),s.opacity=e.opacity(),s.localopacity=e.localopacity(),s.masklimen=e.masklimen(),s.positionX=e.positionX(),s.positionY=e.positionY(),s.pivotX=e.pivotX(),s.pivotY=e.pivotY(),s.rotationX=e.rotationX(),s.rotationY=e.rotationY(),s.rotationZ=e.rotationZ(),s.scaleX=e.scaleX(),s.scaleY=e.scaleY(),s.localscaleX=e.localscaleX(),s.localscaleY=e.localscaleY(),s.size_X=e.sizeX(),s.size_Y=e.sizeY(),s.uv_move_X=e.uvMoveX(),s.uv_move_Y=e.uvMoveY(),s.uv_rotation=e.uvRotation(),s.uv_scale_X=e.uvScaleX(),s.uv_scale_Y=e.uvScaleY(),s.boundingRadius=e.boundingRadius(),s.instanceValue_curKeyframe=e.instanceValueCurKeyframe(),s.instanceValue_endFrame=e.instanceValueEndFrame(),s.instanceValue_startFrame=e.instanceValueStartFrame(),s.instanceValue_loopNum=e.instanceValueLoopNum(),s.instanceValue_speed=e.instanceValueSpeed(),s.instanceValue_loopflag=e.instanceValueLoopflag(),s.effectValue_curKeyframe=e.effectValueCurKeyframe(),s.effectValue_startTime=e.effectValueStartTime(),s.effectValue_speed=e.effectValueSpeed(),s.effectValue_loopflag=e.effectValueLoopflag(),s.f_hide=!1,s.f_flipH=!1,s.f_flipV=!1,s.f_mesh=!1,s.i_transformVerts=0,s.u00=0,s.v00=0,s.u01=0,s.v01=0,s.u10=0,s.v10=0,s.u11=0,s.v11=0,s.useColorMatrix=!1,s.colorBlendType=0,s.colorRate=0,s.colorArgb32=0,s.meshIsBind=0,s.meshNum=0,s.meshDataPoint=null,s.flag1=0,s.flag2=0,s.partsColorARGB=0,s}InheritOpacity(t,e,s){return t=this.GetFrameData(s)[e].opacity/255,this._parentIndex[e]>=0&&(t=this.InheritOpacity(t,this._parentIndex[e],s)),t}TransformVertsLocal(t,e,s){const a=this.GetFrameData(s)[e],c=-a.rotationZ*Math.PI/180,n=Math.cos(c),h=Math.sin(c);for(let r=0;r<t.length/2;r++){let o=t[r*2],l=t[r*2+1];a.i_transformVerts&1&&r===1&&(o+=a.u00,l-=a.v00),a.i_transformVerts&2&&r===2&&(o+=a.u01,l-=a.v01),a.i_transformVerts&4&&r===3&&(o+=a.u10,l-=a.v10),a.i_transformVerts&8&&r===4&&(o+=a.u11,l-=a.v11),o*=a.scaleX*a.localscaleX,l*=a.scaleY*a.localscaleY,t[r*2]=n*o-h*l+a.positionX,t[r*2+1]=h*o+n*l-a.positionY,a.f_flipH&&(t[r*2]=t[0]*2-t[r*2]),a.f_flipV&&(t[r*2+1]=t[1]*2-t[r*2+1])}return this._parentIndex[e]>=0&&(t=this.TransformVerts(t,this._parentIndex[e],s)),t}TransformMeshVertsLocal(t,e,s){const a=this.GetFrameData(s)[e],c=-a.rotationZ*Math.PI/180,n=Math.cos(c),h=Math.sin(c);for(let r=0;r<t.length/2;r++){let o=t[r*2],l=t[r*2+1];o*=a.scaleX*a.localscaleX,l*=a.scaleY*a.localscaleY,t[r*2]=n*o-h*l+a.positionX,t[r*2+1]=h*o+n*l-a.positionY}return this._parentIndex[e]>=0&&(t=this.TransformVerts(t,this._parentIndex[e],s)),t}TransformPositionLocal(t,e,s){const a=this.GetFrameData(s)[e];t[4]+=-a.rotationZ;const c=-a.rotationZ*Math.PI/180,n=Math.cos(c),h=Math.sin(c),r=t[0]*a.scaleX*a.localscaleX,o=t[1]*a.scaleY*a.localscaleY;return t[2]*=a.scaleX*a.localscaleX,t[3]*=a.scaleY*a.localscaleY,t[0]=n*r-h*o+a.positionX,t[1]=h*r+n*o-a.positionY,this._parentIndex[e]>=0&&(t=this.TransformPosition(t,this._parentIndex[e],s)),t}static CoordinateGetDiagonalIntersection(t,e,s,a,c,n,h,r,o,l,d){const u=(r-n)*(h-s)-(h-c)*(r-a),p=(o-s)*(r-a)-(l-a)*(h-s),m=(o-s)*(r-n)-(l-a)*(h-c);if(m<=0&&m>=0)return d;const f=u/m,I=p/m;return 0<=f&&1>=f&&0<=I&&1>=I&&(t=s+f*(o-s),e=a+f*(l-a)),d[0]=t,d[1]=e,d}TransformVerts(t,e,s){const a=this.GetFrameData(s)[e],c=-a.rotationZ*Math.PI/180,n=Math.cos(c),h=Math.sin(c);for(let r=0;r<t.length/2;r++){let o=t[r*2],l=t[r*2+1];o*=a.scaleX,l*=a.scaleY,t[r*2]=n*o-h*l+a.positionX,t[r*2+1]=h*o+n*l-a.positionY,a.f_flipH&&(t[r*2]=t[0]*2-t[r*2]),a.f_flipV&&(t[r*2+1]=t[1]*2-t[r*2+1])}return this._parentIndex[e]>=0&&(t=this.TransformVerts(t,this._parentIndex[e],s)),t}TransformPosition(t,e,s){const a=this.GetFrameData(s)[e];t[4]+=-a.rotationZ;const c=-a.rotationZ*Math.PI/180,n=Math.cos(c),h=Math.sin(c),r=t[0]*a.scaleX,o=t[1]*a.scaleY;return t[2]*=a.scaleX,t[3]*=a.scaleY,t[0]=n*r-h*o+a.positionX,t[1]=h*r+n*o-a.positionY,this._parentIndex[e]>=0&&(t=this.TransformPosition(t,this._parentIndex[e],s)),t}static GetVerts(t,e,s){const a=e.size_X/2,c=e.size_Y/2,n=e.size_X*-(e.pivotX+t.pivotX()),h=e.size_Y*(e.pivotY+t.pivotY());return s.set([n,h,n-a,h-c,n+a,h-c,n-a,h+c,n+a,h+c]),s}static GetMeshVerts(t,e,s){for(let a=0;a<e.meshNum;a++)s[a*2]=e.meshDataPoint[a*3],s[a*2+1]=-e.meshDataPoint[a*3+1];return s}static GetDummyVerts(){return new Float32Array([0,0,-.5,-.5,.5,-.5,-.5,.5,.5,.5])}}class gt{constructor(t,e,s,a,c,n,h){if(typeof t=="string"){let r=t,o=e,l=s!==void 0?s:0,d=a!==void 0?a:0,u=c!==void 0?c:null,p=n!==void 0?n:null,m=h!==void 0?h:null;this.ssfbPath=r;const f=r.lastIndexOf("/");this.rootPath=r.substring(0,f)+"/",this.status="not ready",this.onComplete=o,this.onError=u,this.onTimeout=p,this.onRetry=m,this.LoadFlatBuffersProject(r,l,d)}else if(typeof t=="object"&&t.constructor===Uint8Array){let r=t,o=e;this.onComplete=s!==void 0?s:null,this.load(r,o)}}LoadFlatBuffersProject(t,e=0,s=0){const a=this,c=new XMLHttpRequest,n="GET";c.open(n,t,!0),c.responseType="arraybuffer",c.timeout=e,c.onload=function(){if(!(c.status>=200&&c.status<400)){a.onError!==null&&a.onError(t,e,s,c);return}const h=this.response,r=new Uint8Array(h);a.fbObj=It.getProjectData(r),a.LoadCellResources()},c.ontimeout=function(){s>0?(a.onRetry!==null&&a.onRetry(t,e,s-1,c),a.LoadFlatBuffersProject(t,e,s-1)):a.onTimeout!==null&&a.onTimeout(t,e,s,c)},c.onerror=function(){a.onError!==null&&a.onError(t,e,s,c)},c.send(null)}LoadCellResources(){const t=this;let e=new Dt.Loader,s=[];for(let a=0;a<t.fbObj.cellsLength();a++)s.some(function(c){return c===t.fbObj.cells(a).cellMap().index()})||(s.push(t.fbObj.cells(a).cellMap().index()),e.add(t.fbObj.cells(a).cellMap().name(),t.rootPath+this.fbObj.cells(a).cellMap().imagePath()));e.load(function(a,c){t.resources=c,t.status="ready",t.onComplete!==null&&t.onComplete()})}load(t,e){this.fbObj=It.getProjectData(t);const s=new Dt.Loader;for(let c in e){const n=e[c];let h="";const r=n.byteLength;for(let l=0;l<r;l++)h+=String.fromCharCode(n[l]);const o="data:image/png;base64,"+window.btoa(h);s.add(c,o)}const a=this;s.load((c,n)=>{a.resources=n,a.status="ready",a.onComplete!==null&&a.onComplete()})}}class Gt{constructor(){this.refStartframe=0,this.refEndframe=0,this.refSpeed=1,this.refloopNum=0,this.infinity=!1,this.reverse=!1,this.pingpong=!1,this.independent=!1}}class G extends Ct.Container{constructor(t,e=null,s=null){super(),this.liveFrame=[],this.colorMatrixFilterCache=[],this.parentAlpha=1,this.prevCellID=[],this.prevMesh=[],this.substituteOverWrite=[],this.substituteKeyParam=[],this.alphaBlendType=[],this.defaultColorFilter=new xt.ColorMatrixFilter,this._instancePos=new Float32Array(5),this._CoordinateGetDiagonalIntersectionVec2=new Float32Array(2),this.ss6project=t,this.playerLib=new ct(t.fbObj,e,s),this.resources=this.ss6project.resources,this.parentAlpha=1,e!==null&&s!==null&&this.Setup(e,s),this.on("added",(...a)=>{mt.Ticker.shared.add(this.Update,this)},this),this.on("removed",(...a)=>{mt.Ticker.shared.remove(this.Update,this)},this)}get startFrame(){return this._startFrame}get endFrame(){return this._endFrame}get totalFrame(){return this.playerLib.animationData.totalFrames()}get fps(){return this.playerLib.animationData.fps()}get frameNo(){return Math.floor(this._currentFrame)}set loop(t){this._loops=t}get loop(){return this._loops}get isPlaying(){return this._isPlaying}get isPausing(){return this._isPausing}get animePackName(){return this.playerLib.animePackName}get animeName(){return this.playerLib.animeName}Setup(t,e){this.playerLib.Setup(t,e),this.clearCaches();const s=this.playerLib.animePackData,a=s.partsLength();this.prevCellID=new Array(a),this.prevMesh=new Array(a),this.substituteOverWrite=new Array(a),this.substituteKeyParam=new Array(a);for(let c=0;c<a;c++){const n=s.parts(c).index();this.prevCellID[n]=-1,this.prevMesh[n]=null,this.substituteOverWrite[n]=null,this.substituteKeyParam[n]=null}this.alphaBlendType=this.GetPartsBlendMode(),this._isPlaying=!1,this._isPausing=!0,this._startFrame=this.playerLib.animationData.startFrames(),this._endFrame=this.playerLib.animationData.endFrames(),this._currentFrame=this.playerLib.animationData.startFrames(),this.nextFrameTime=0,this._loops=-1,this.skipEnabled=!0,this.updateInterval=1e3/this.playerLib.animationData.fps(),this.playDirection=1,this.onUserDataCallback=null,this.playEndCallback=null,this.parentAlpha=1}clearCaches(){this.liveFrame=[],this.colorMatrixFilterCache=[]}Update(t){this.UpdateInternal(t)}UpdateInternal(t,e=!0){const s=mt.Ticker.shared.elapsedMS;if(this._isPlaying&&!this._isPausing&&this.updateInterval!==0){if(this.nextFrameTime+=s,this.nextFrameTime>=this.updateInterval){let c=!1;const n=this.nextFrameTime/this.updateInterval;this.nextFrameTime-=this.updateInterval*n;let h=this.skipEnabled?n*this.playDirection:this.playDirection,r=this._currentFrame+h,o=Math.floor(r),l=r-o,d=Math.floor(this._currentFrame);if(this.playDirection>=1)for(let u=o-d;u;u--){let p=d+1;if(p>this._endFrame)if(this._loops===-1)p=this._startFrame;else if(this._loops--,c=!0,this._loops===0){this._isPlaying=!1,p=e?this._startFrame:this._endFrame;break}else p=this._startFrame;d=p,this._isPlaying&&this.playerLib.HaveUserData(d)&&this.onUserDataCallback!==null&&this.onUserDataCallback(this.playerLib.GetUserData(d))}if(this.playDirection<=-1)for(let u=d-o;u;u--){let p=d-1;if(p<this._startFrame)if(this._loops===-1)p=this._endFrame;else if(this._loops--,c=!0,this._loops===0){this._isPlaying=!1,p=e?this._endFrame:this._startFrame;break}else p=this._endFrame;d=p,this._isPlaying&&this.playerLib.HaveUserData(d)&&this.onUserDataCallback!==null&&this.onUserDataCallback(this.playerLib.GetUserData(d))}this._currentFrame=d+l,c&&this.playEndCallback!==null&&this.playEndCallback(this),this.SetFrameAnimation(Math.floor(this._currentFrame),n)}}else this.SetFrameAnimation(Math.floor(this._currentFrame))}SetAnimationFramerate(t,e=!0){t<=0||(this.updateInterval=1e3/t,this.skipEnabled=e)}SetAnimationSpeed(t,e=!0){t!==0&&(this.playDirection=t>0?1:-1,this.updateInterval=1e3/(this.playerLib.animationData.fps()*t*this.playDirection),this.skipEnabled=e)}SetAnimationSection(t=-1,e=-1,s=-1){t>=0&&t<this.playerLib.animationData.totalFrames()&&(this._startFrame=t),e>=0&&e<this.playerLib.animationData.totalFrames()&&(this._endFrame=e),s>0?this._loops=s:this._loops=-1,this._currentFrame=this.playDirection>0?this._startFrame:this._endFrame}Play(t){this._isPlaying=!0,this._isPausing=!1;let e=this.playDirection>0?this._startFrame:this._endFrame;t&&typeof t=="number"&&(e=t),this._currentFrame=e,this.resetLiveFrame();const s=Math.floor(this._currentFrame);this.SetFrameAnimation(s),this.playerLib.HaveUserData(s)&&this.onUserDataCallback!==null&&this.onUserDataCallback(this.playerLib.GetUserData(s))}Pause(){this._isPausing=!0}Resume(){this._isPausing=!1}Stop(){this._isPlaying=!1}SetFrame(t){this._currentFrame=t}NextFrame(){const t=Math.floor(this._currentFrame),e=this.endFrame;t!==e&&this.SetFrame(t+1)}PrevFrame(){const t=Math.floor(this._currentFrame);t!==0&&this.SetFrame(t-1)}SetAlpha(t){this.parentAlpha=t}ThrowError(t){}SetUserDataCalback(t){this.onUserDataCallback=t}SetPlayEndCallback(t){this.playEndCallback=t}GetPartsBlendMode(){const t=this.playerLib.animePackData,e=t.partsLength();let s=[];for(let a=0;a<e;a++){const c=t.parts(a).alphaBlendType();let n;switch(c){case 0:n=w.BLEND_MODES.NORMAL;break;case 1:n=w.BLEND_MODES.MULTIPLY;break;case 2:n=w.BLEND_MODES.ADD;break;case 3:n=w.BLEND_MODES.NORMAL;break;case 4:n=w.BLEND_MODES.MULTIPLY;break;case 5:n=w.BLEND_MODES.SCREEN;break;case 6:n=w.BLEND_MODES.EXCLUSION;break;case 7:n=w.BLEND_MODES.NORMAL;break;default:n=w.BLEND_MODES.NORMAL;break}s.push(n)}return s}GetColorMatrixFilter(t,e,s){const a=t.toString()+"_"+e.toString()+"_"+s.toString();if(this.colorMatrixFilterCache[a])return this.colorMatrixFilterCache[a];const c=new xt.ColorMatrixFilter,n=((s&4278190080)>>>24)/255,h=((s&16711680)>>>16)/255,r=((s&65280)>>>8)/255,o=(s&255)/255;if(t===0){const l=1-e;c.matrix=[l,0,0,0,h*e,0,l,0,0,r*e,0,0,l,0,o*e,0,0,0,1,0]}else t===1?c.matrix=[h,0,0,0,0,0,r,0,0,0,0,0,o,0,0,0,0,0,n,0]:t===2?c.matrix=[1,0,0,0,h,0,1,0,0,r,0,0,1,0,o,0,0,0,n,0]:t===3&&(c.matrix=[1,0,0,0,-h,0,1,0,0,-r,0,0,1,0,-o,0,0,0,n,0]);return this.colorMatrixFilterCache[a]=c,c}SetFrameAnimation(t,e=0){const s=this.playerLib.GetFrameData(t);this.removeChildren();const a=s.length;for(let c=0;c<a;c=c+1|0){const n=this.playerLib.prio2index[c],h=s[n],r=h.cellIndex;let o=this.prevMesh[n];const l=this.playerLib.animePackData.parts(n),d=l.type();let u=this.substituteOverWrite[n]!==null?this.substituteOverWrite[n]:!1,p=this.substituteKeyParam[n];switch(d){case v.Instance:o==null&&(o=this.MakeCellPlayer(l.refname()),o.name=l.name());break;case v.Normal:case v.Mask:r>=0&&this.prevCellID[n]!==r&&(o?.destroy(),o=this.MakeCellMesh(r),o.name=l.name());break;case v.Mesh:r>=0&&this.prevCellID[n]!==r&&(o?.destroy(),o=this.MakeMeshCellMesh(n,r),o.name=l.name());break;case v.Nulltype:case v.Joint:this.prevCellID[n]!==r&&(o?.destroy(),o=new Ct.Container,o.name=l.name());break;default:r>=0&&this.prevCellID[n]!==r&&(o?.destroy(),o=this.MakeCellMesh(r),o.name=l.name());break}if(o!=null)switch(this.prevCellID[n]=r,this.prevMesh[n]=o,d){case v.Instance:{this._instancePos[0]=0,this._instancePos[1]=0,this._instancePos[2]=1,this._instancePos[3]=1,this._instancePos[4]=0,this._instancePos=this.playerLib.TransformPositionLocal(this._instancePos,h.index,t),o.rotation=this._instancePos[4]*Math.PI/180,o.position.set(this._instancePos[0],this._instancePos[1]),o.scale.set(this._instancePos[2],this._instancePos[3]);let m=h.opacity/255;h.localopacity<255&&(m=h.localopacity/255),o.SetAlpha(m*this.parentAlpha),o.visible=!h.f_hide;let f=h.instanceValue_curKeyframe,I=h.instanceValue_startFrame,F=h.instanceValue_endFrame,Z=h.instanceValue_speed,q=h.instanceValue_loopNum,g=!1,M=!1,A=!1,U=!1;const L=1,x=2,X=4,B=8,T=h.instanceValue_loopflag;T&L&&(g=!0),T&x&&(M=!0),T&X&&(A=!0),T&B&&(U=!0),u&&(I=p.refStartframe,F=p.refEndframe,Z=p.refSpeed,q=p.refloopNum,g=p.infinity,M=p.reverse,A=p.pingpong,U=p.independent),(o._startFrame!==I||o._endFrame!==F)&&o.SetAnimationSection(I,F);let N=t;U===!0&&(this.liveFrame[c]+=e,N=Math.floor(this.liveFrame[c]));const Q=f;let j=Math.floor((N-Q)*Z);if(j<0||Q>N)continue;const z=F-I+1;if(z<=0)continue;let K=Math.floor(j/z),H=q;A&&(H=H*2),g||K>=H&&(j=z-1,K=H-1);const it=Math.floor(j%z);let at=0;A&&K%2===1&&(M?M=!1:M=!0),this.playDirection<=-1&&(M=!M),M?at=F-it:at=it+I,o.SetFrame(Math.floor(at)),this.addChild(o);break}case v.Normal:case v.Mesh:case v.Joint:case v.Mask:{const m=this.playerLib.fbObj.cells(r);let f;if(d===v.Mesh?h.meshIsBind===0?f=this.playerLib.TransformMeshVertsLocal(ct.GetMeshVerts(m,h,o.vertices),h.index,t):f=ct.GetMeshVerts(m,h,o.vertices):(f=d===v.Joint?new Float32Array(10):o.vertices,f=this.playerLib.TransformVertsLocal(ct.GetVerts(m,h,f),h.index,t)),h.flag1&b.VERTEX_TRANSFORM){const g=f[6],M=f[3*2+1],A=f[1*2+0],U=f[1*2+1],L=f[4*2+0],x=f[4*2+1],X=f[2*2+0],B=f[2*2+1],T=(g+L)*.5,N=(M+x)*.5,Q=(g+A)*.5,j=(M+U)*.5,z=(A+X)*.5,K=(U+B)*.5,H=(L+X)*.5,it=(x+B)*.5,at=ct.CoordinateGetDiagonalIntersection(f[0],f[1],T,N,H,it,Q,j,z,K,this._CoordinateGetDiagonalIntersectionVec2);f[0]=at[0],f[1]=at[1]}const I=f[0],F=f[1];for(let g=0;g<f.length/2;g++)f[g*2]-=I,f[g*2+1]-=F;if(o.vertices=f,h.flag1&b.U_MOVE||h.flag1&b.V_MOVE||h.flag1&b.U_SCALE||h.flag1&b.V_SCALE||h.flag1&b.UV_ROTATION){const g=m.u1()+h.uv_move_X,M=m.u2()+h.uv_move_X,A=m.v1()+h.uv_move_Y,U=m.v2()+h.uv_move_Y,L=(M+g)/2,x=(U+A)/2,X=(M-g)/2*h.uv_scale_X,B=(U-A)/2*h.uv_scale_Y;if(o.uvs[0]=L,o.uvs[1]=x,o.uvs[2]=L-X,o.uvs[3]=x-B,o.uvs[4]=L+X,o.uvs[5]=x-B,o.uvs[6]=L-X,o.uvs[7]=x+B,o.uvs[8]=L+X,o.uvs[9]=x+B,h.flag1&b.UV_ROTATION){const T=h.uv_rotation*Math.PI/180;for(let N=0;N<5;N++){const Q=o.uvs[N*2+0]-L,j=o.uvs[N*2+1]-x,z=Math.cos(T),K=Math.sin(T),H=z*Q-K*j,it=K*Q+z*j;o.uvs[N*2+0]=L+H,o.uvs[N*2+1]=x+it}}o.dirty++}o.position.set(I,F);let Z=h.opacity/255;if(h.localopacity<255&&(Z=h.localopacity/255),o.alpha=Z*this.parentAlpha,o.visible=!h.f_hide,h.useColorMatrix){const g=this.GetColorMatrixFilter(h.colorBlendType,h.colorRate,h.colorArgb32);o.filters=[g]}if(h.tint){o.tint=h.tint;const g=((h.partsColorARGB&4278190080)>>>24)/255;o.alpha=o.alpha*g}const q=this.alphaBlendType[n];(q===w.BLEND_MODES.MULTIPLY||q===w.BLEND_MODES.SCREEN)&&(o.alpha=1),d!==v.Mask&&this.addChild(o);break}case v.Nulltype:{const m=this.playerLib.InheritOpacity(1,h.index,t);o.alpha=m*h.localopacity/255;const f=this.playerLib.TransformVerts(ct.GetDummyVerts(),h.index,t),I=f[0],F=f[1];o.position.set(I,F);const Z=Math.atan2(f[5]-f[3],f[4]-f[2]),q=Math.atan2(f[7]-f[3],f[6]-f[2]);o.rotation=Z,o.skew.x=q-Z-Math.PI/2;break}}}}ChangeInstanceAnime(t,e,s,a,c=null){let n=!1;if(this.animePackName!==null&&this.animeName!==null){let h=this.playerLib.animePackData,r=h.partsLength();for(let o=0;o<r;o++){let l=h.parts(o);if(l.name()===t){let d=this.prevMesh[o];if(d===null||d instanceof G){this.substituteOverWrite[o]=a;let u;c!==null?(u=c,d=this.MakeCellPlayer(e+"/"+s,c.refStartframe)):(d=this.MakeCellPlayer(e+"/"+s),u=new Gt,u.refStartframe=d.startFrame,u.refEndframe=d.endFrame),d.name=l.name(),this.prevMesh[o]=d,this.substituteKeyParam[o]=u,n=!0;break}}}}return n}MakeCellMesh(t){const e=this.playerLib.fbObj.cells(t),s=e.u1(),a=e.u2(),c=e.v1(),n=e.v2(),h=e.width()/2,r=e.height()/2,o=new Float32Array([0,0,-h,-r,h,-r,-h,r,h,r]),l=new Float32Array([(s+a)/2,(c+n)/2,s,c,a,c,s,n,a,n]),d=new Uint16Array([0,1,2,0,2,4,0,4,3,0,1,3]);return new Lt.SimpleMesh(this.resources[e.cellMap().name()].texture,o,l,d,w.DRAW_MODES.TRIANGLES)}MakeMeshCellMesh(t,e){const s=this.playerLib.animationData.meshsDataUv(t),a=s.uvLength();if(a>0){const c=new Float32Array(a-2),n=s.uv(1);for(let d=2;d<a;d++)c[d-2]=s.uv(d);const h=this.playerLib.animationData.meshsDataIndices(t),r=h.indicesLength(),o=new Uint16Array(r-1);for(let d=1;d<r;d++)o[d-1]=h.indices(d);const l=new Float32Array(n*2);return new Lt.SimpleMesh(this.resources[this.playerLib.fbObj.cells(e).cellMap().name()].texture,l,c,o,w.DRAW_MODES.TRIANGLES)}return null}MakeCellPlayer(t,e=void 0){const s=t.split("/"),a=new G(this.ss6project);return a.Setup(s[0],s[1]),a.Play(e),a}resetLiveFrame(){const t=this.playerLib.animationData.defaultDataLength();for(let e=0;e<t;e++)this.liveFrame[e]=0}}var qt=Object.defineProperty,Qt=(i,t,e)=>t in i?qt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Y=(i,t,e)=>(Qt(i,typeof t!="symbol"?t+"":t,e),e);const Yt=class ht{constructor(){Y(this,"pluginParameters"),Y(this,"animationDir"),Y(this,"replaceSVActorSpriteFlag"),Y(this,"svActorDir"),Y(this,"svActorAnimationPack"),Y(this,"svActorHideWeaponGraphics"),Y(this,"replaceSVEnemySpriteFlag"),Y(this,"svEnemyDir"),Y(this,"svEnemyAnimationPack"),Y(this,"svEnemyAnimationName"),this.pluginParameters=PluginManager.parameters("ss6player-rpgmakermz"),this.animationDir=String(this.pluginParameters.animationDir||"img/ssfb")+"/",this.replaceSVActorSpriteFlag=this.pluginParameters.replaceSVActorSpriteFlag==="true"||!1,this.svActorDir=String(this.pluginParameters.svActorDir||"img/ssfb/sv_actors")+"/",this.svActorAnimationPack=String(this.pluginParameters.svActorAnimationPack||"motions"),this.svActorHideWeaponGraphics=this.pluginParameters.svActorHideWeaponGraphics==="true"||!1,this.replaceSVEnemySpriteFlag=this.pluginParameters.replaceSVEnemySpriteFlag==="true"||!1,this.svEnemyDir=String(this.pluginParameters.svEnemyDir||"img/ssfb/sv_enemies")+"/",this.svEnemyAnimationPack=String(this.pluginParameters.svEnemyAnimationPack||"motions"),this.svEnemyAnimationName=String(this.pluginParameters.svEnemyAnimationName||"walk")}static getInstance(){return ht.instance||(ht.instance=new ht),ht.instance}};Y(Yt,"instance");let E=Yt;var te=Object.defineProperty,ee=(i,t,e)=>t in i?te(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ft=(i,t,e)=>(ee(i,typeof t!="symbol"?t+"":t,e),e);const Ut=class lt{constructor(){Ft(this,"ssprojectMap"),Ft(this,"_isLoading"),this.clear(),this._isLoading=!1}prepare(t){this.ssprojectMap.set(t,null),this._isLoading=!0}isLoading(){return this._isLoading}isExist(t){return this.ssprojectMap.has(t)&&this.ssprojectMap.get(t)!==null}set(t,e){this.ssprojectMap.set(t,e),this._isLoading=!1}get(t){return this.ssprojectMap.has(t)?this.ssprojectMap.get(t):null}clear(){this.ssprojectMap=new Map}static getInstance(){return lt.instance||(lt.instance=new lt),lt.instance}};Ft(Ut,"instance");let y=Ut;const vt="ss6player-rpgmakermz",Xt="ss6projectLoadWait",Bt="ss6playerPlayWaitMode";let Pt=!1,ut=null,Et=null,Tt=null;PluginManager.registerCommand(vt,"loadSsfb",function(i){const t=Number(i.ssfbId),e=i.ssfbFile,s=E.getInstance().animationDir+e;if(y.getInstance().isExist(t)){const c=y.getInstance().get(t);if(s===c.ssfbPath)return}this.setWaitMode(Xt),y.getInstance().prepare(t);let a=new gt(s,()=>{y.getInstance().set(t,a)},180*1e3,3,(c,n,h,r)=>{throw this.setWaitMode(""),r},(c,n,h,r)=>{throw console.log("timeout download ssfb file: "+c),this.setWaitMode(""),r},null)}),PluginManager.registerCommand(vt,"setAsPicture",function(i){const t=Number(i.ssfbId),e=i.animePackName,s=i.animeName,a=Number(i.scaleX)||1,c=Number(i.scaleY)||1,n=Number(i.loop)||1;let h=y.getInstance().get(t);if(h===null){const o="not found ssfbId: "+t;throw console.error(o),o}let r=new G(h,e,s);r.scale=new PIXI.Point(a,c),r.loop=n,ut=r}),PluginManager.registerCommand(vt,"waitForPicture",function(i){const t=Number(i.pictureId)||1,e=$gameScreen.picture(t);e&&e.mzkpSS6Player?e.mzkpSS6Player instanceof G&&(e.mzkpSS6Player.loop!==-1?(this.setWaitMode(Bt),Pt=!0,Et=function(a){a.loop===0&&(Pt=!1)}):console.warn("pictureId: "+t+" can not wait SS6Player because setting infinity loop.")):console.warn("pictureId: "+t+" not have SS6Player")});const se=Game_Interpreter.prototype.updateWaitMode;Game_Interpreter.prototype.updateWaitMode=function(){let i=!1;return this._waitMode===Xt?i=y.getInstance().isLoading():this._waitMode===Bt?i=Pt:i=se.call(this),i};const ie=Game_Picture.prototype.show;Game_Picture.prototype.show=function(){ie.apply(this,arguments),this._name===""&&ut!==null&&(this.mzkpSS6Player=ut,this.mzkpSS6PlayerChanged=!0,ut=null)};const ae=Sprite_Picture.prototype.destroy;Sprite_Picture.prototype.destroy=function(i){this.mzkpSS6Player!==null&&this.mzkpSS6Player instanceof G&&(this.mzkpSS6Player.Stop(),this.picture().mzkpSS6PlayerPrevFrameNo=this.mzkpSS6Player.frameNo,this.removeChild(this.mzkpSS6Player),this.mzkpSS6Player=null),ae.call(this,i)};const ne=Game_Screen.prototype.erasePicture;Game_Screen.prototype.erasePicture=function(i){const t=this._pictures[i];t&&t.mzkpSS6Player&&(t.mzkpSS6Player=null),ne.call(this,i)};const oe=Scene_Base.prototype.terminate;Scene_Base.prototype.terminate=function(){$gameActors._data.forEach((i,t,e)=>{i&&i._svActorSS6Player&&(i._svActorSS6Player.Stop(),i._svActorSS6PlayerParent.removeChild(i._svActorSS6Player),i._svActorSS6Player=null,i._svActorSS6PlayerParent=null)}),$gameTroop.members().forEach((i,t,e)=>{i&&i._svEnemySS6Player&&(i._svEnemySS6Player.Stop(),i._svEnemySS6PlayerParent.removeChild(i._svEnemySS6Player),i._svEnemySS6ProjectLoaded=!1,i._svEnemySS6Player=null,i._svEnemySS6PlayerParent=null)}),oe.apply(this,arguments)};const re=Sprite_Picture.prototype.updateBitmap;Sprite_Picture.prototype.updateBitmap=function(){if(re.apply(this,arguments),this.visible&&this._pictureName===""){const i=this.picture(),t=i&&i.mzkpSS6Player||null,e=i&&i.mzkpSS6PlayerChanged;if(this.mzkpSS6Player!==t||e)if(t!==null){if(t.loop===0){this.mzkpSS6Player&&(this.mzkpSS6Player.Stop(),this.removeChild(this.mzkpSS6Player),this.mzkpSS6Player=null,i.mzkpSS6Player=null);return}const s=Et,a=Tt,c=this;t.SetPlayEndCallback(()=>{s!==null&&s(t),t.loop===0&&(t.Stop(),c.removeChild(t)),a!==null&&a(t)}),this.mzkpSS6Player&&(this.mzkpSS6Player.Stop(),this.removeChild(this.mzkpSS6Player)),this.mzkpSS6Player=t,this.addChild(this.mzkpSS6Player),this.mzkpSS6Player.Play(i.mzkpSS6PlayerPrevFrameNo),i.mzkpSS6PlayerChanged=!1,Et=null,Tt=null}else this.mzkpSS6Player=null}else this.mzkpSS6Player!==null&&this.mzkpSS6Player instanceof G&&(this.mzkpSS6Player.Stop(),this.removeChild(this.mzkpSS6Player)),this.mzkpSS6Player=null};const ce=Game_Screen.prototype.clear;Game_Screen.prototype.clear=function(){y.getInstance().clear(),ce.call(this)};let Ot=!1;const he=SceneManager.updateScene;SceneManager.updateScene=function(){he.apply(this,arguments),this._scene&&(this.isGameActive()?Ot&&($gameScreen._pictures.forEach((i,t,e)=>{i&&i.mzkpSS6Player&&i.mzkpSS6Player.Resume()}),$gameActors._data.forEach((i,t,e)=>{i&&i._svActorSS6Player&&i._svActorSS6Player.Resume()}),$gameTroop.members().forEach((i,t,e)=>{i&&i._svEnemySS6Player&&i._svEnemySS6Player.Resume()}),Ot=!1):($gameScreen&&$gameScreen._pictures&&$gameScreen._pictures.forEach((i,t,e)=>{i&&i.mzkpSS6Player&&i.mzkpSS6Player.Pause()}),$gameActors&&$gameActors._data&&$gameActors._data.forEach((i,t,e)=>{i&&i._svActorSS6Player&&i._svActorSS6Player.Pause()}),$gameTroop&&$gameTroop.members()&&$gameTroop.members().forEach((i,t,e)=>{i&&i._svEnemySS6Player&&i._svEnemySS6Player.Pause()}),Ot=!0))};let jt=!1;const zt=DataManager.isDatabaseLoaded;DataManager.isDatabaseLoaded=function(){return E.getInstance().replaceSVEnemySpriteFlag?zt.call(this)?(jt||(this.loadEnemyNoteTags(),jt=!0),!0):!1:zt.call(this)};const le="SS6SVEnemy",de="file",fe="animationPackName",_e="animationName",be="scaleX",pe="scaleY",ue="offsetX",me="offsetY";DataManager.loadEnemyNoteTags=function(){const i=new RegExp("<"+le+" (.*):(.*)>","i");$dataEnemies.forEach((t,e,s)=>{if(t===null)return;t.note.split(/\r?\n/).forEach((c,n,h)=>{const r=i.exec(c);if(r&&r.length===3){const o=r[1].toLowerCase(),l=r[2];switch(o){case de.toLowerCase():t._svEnemyFile=l;break;case fe.toLowerCase():t._svEnemyAnimationPackName=l;break;case _e.toLowerCase():t._svEnemyAnimationName=l;break;case be.toLowerCase():t._svEnemyScaleX=Number(l);break;case pe.toLowerCase():t._svEnemyScaleY=Number(l);break;case ue.toLowerCase():t._svEnemyOffsetX=Number(l);break;case me.toLowerCase():t._svEnemyOffsetY=Number(l);break}}})})},Sprite_Actor.svActorSsfbId=function(i){return"sv_actor_"+i},Sprite_Actor.svActorSsfbDir=function(i){return E.getInstance().svActorDir+String(i)+"/"},Sprite_Actor.svActorSsfbPath=function(i){return Sprite_Actor.svActorSsfbDir(i)+String(i)+".ssfb"};let Rt=new Map;const Se=Sprite_Actor.prototype.setBattler;Sprite_Actor.prototype.setBattler=function(i){const t=i!==this._actor;if(Se.call(this,i),E.getInstance().replaceSVActorSpriteFlag&&t){let e,s,a;if(Imported.VisuMZ_0_CoreEngine&&Imported.VisuMZ_1_BattleCore&&this instanceof Sprite_SvEnemy?(e=this._actor.enemyId(),s="sv_enemy_"+e,a=E.getInstance().svActorDir+"svenemy"+String(e)+"/"+String(e)+".ssfb"):(e=this._actor.actorId(),s=Sprite_Actor.svActorSsfbId(e),a=Sprite_Actor.svActorSsfbPath(e)),Rt.has(s))return;if(y.getInstance().isExist(s)){const n=y.getInstance().get(s);if(a===n.ssfbPath){this._actor._svActorSS6Player=null,this._actor._svActorSS6PlayerParent=null;return}}y.getInstance().prepare(s);let c=new gt(a,()=>{this._actor._svActorSS6Player=null,this._actor._svActorSS6PlayerParent=null,y.getInstance().set(s,c)},180*1e3,3,(n,h,r,o)=>{Rt.set(s,null),y.getInstance().set(s,null)})}};const Wt=Sprite_Actor.prototype.updateBitmap;Sprite_Actor.prototype.updateBitmap=function(){if(E.getInstance().replaceSVActorSpriteFlag){const i=this._actor.actorId(),t=Sprite_Actor.svActorSsfbId(i);y.getInstance().isExist(t)&&this._actor._svActorSS6Player!==void 0?(Sprite_Battler.prototype.updateBitmap.call(this),this._mainSprite.bitmap=null,this.updateSS6Player()):Wt.call(this)}else Wt.call(this)},Sprite_Actor.prototype.updateSS6Player=function(){let i="";for(let t in Sprite_Actor.MOTIONS){const e=Sprite_Actor.MOTIONS[t];this._motion===e&&(i=t)}if(i===""&&(i="walk"),this._actor._svActorSS6Player===null||this._actor._svActorSS6Player.animeName!==i){this._actor._svActorSS6Player&&(this._mainSprite.removeChild(this._actor._svActorSS6Player),this._actor._svActorSS6Playe=null,this._actor._svActorSS6PlayerParent=null);const t=this._motion.loop,e=this._actor.actorId(),s=Sprite_Actor.svActorSsfbId(e),a=y.getInstance().get(s),c=E.getInstance().svActorAnimationPack;this._actor._svActorSS6Player=new G(a,c,i),this._actor._svActorSS6Player.loop=t?-1:1,this._actor._svActorSS6Player.SetPlayEndCallback(n=>{n.loop===0&&this.refreshMotion()}),this._actor._svActorSS6Player.Play(),this._mainSprite.addChild(this._actor._svActorSS6Player),this._actor._svActorSS6PlayerParent=this._mainSprite}};const Vt=Sprite_Actor.prototype.setupWeaponAnimation;Sprite_Actor.prototype.setupWeaponAnimation=function(){E.getInstance().replaceSVActorSpriteFlag?E.getInstance().svActorHideWeaponGraphics?this._actor._svActorSS6Player===void 0&&Vt.call(this):Vt.call(this):Vt.call(this)},Sprite_Enemy.svEnemySsfbId=function(i){return"sv_enemy_"+i},Sprite_Enemy.svEnemySsfbDir=function(i){return E.getInstance().svEnemyDir+String(i)+"/"},Sprite_Enemy.svEnemySsfbPath=function(i){return Sprite_Enemy.svEnemySsfbDir(i)+String(i)+".ssfb"};let Zt=new Map;const ye=Sprite_Enemy.prototype.setBattler;Sprite_Enemy.prototype.setBattler=function(i){const t=i!==this._enemy;if(ye.call(this,i),E.getInstance().replaceSVEnemySpriteFlag&&t){const e=this._enemy.enemyId(),s=Sprite_Enemy.svEnemySsfbId(e);if(Zt.has(s))return;let a=Sprite_Enemy.svEnemySsfbPath(e);const c=this._enemy.enemy();if(c._svEnemyFile&&(a=E.getInstance().animationDir+c._svEnemyFile),this._enemy._svEnemySS6ProjectLoaded=!1,y.getInstance().isExist(s)){const h=y.getInstance().get(s);if(a===h.ssfbPath){this._enemy._svEnemySS6ProjectLoaded=!0,this._enemy._svEnemySS6Player=null,this._enemy._svEnemySS6PlayerParent=null;return}}y.getInstance().prepare(s);let n=new gt(a,()=>{this._enemy._svEnemySS6ProjectLoaded=!0,this._enemy._svEnemySS6Player=null,this._enemy._svEnemySS6PlayerParent=null,y.getInstance().set(s,n)},180*1e3,3,(h,r,o,l)=>{this._enemy._svEnemySS6ProjectLoaded=!0,Zt.set(s,null),y.getInstance().set(s,null)})}};const Kt=Sprite_Enemy.prototype.updateBitmap;Sprite_Enemy.prototype.updateBitmap=function(){if(E.getInstance().replaceSVEnemySpriteFlag){const i=this._enemy.enemyId(),t=Sprite_Enemy.svEnemySsfbId(i);if(!this._enemy._svEnemySS6ProjectLoaded)return;y.getInstance().isExist(t)&&this._enemy._svEnemySS6Player!==void 0?(Sprite_Battler.prototype.updateBitmap.call(this),this.bitmap=null,this.updateSS6Player()):Kt.call(this)}else Kt.call(this)},Sprite_Enemy.prototype.updateSS6Player=function(){if(this._enemy._svEnemySS6Player===null){const i=this._enemy.enemyId(),t=Sprite_Enemy.svEnemySsfbId(i),e=y.getInstance().get(t);let s=E.getInstance().svEnemyAnimationPack,a=E.getInstance().svEnemyAnimationName,c=1,n=1,h=0,r=0;const o=this._enemy.enemy();o._svEnemyAnimationPackName&&(s=o._svEnemyAnimationPackName),o._svEnemyAnimationName&&(a=o._svEnemyAnimationName),o._svEnemyScaleX&&(c=o._svEnemyScaleX),o._svEnemyScaleY&&(n=o._svEnemyScaleY),o._svEnemyOffsetX&&(h=o._svEnemyOffsetX),o._svEnemyOffsetY&&(r=o._svEnemyOffsetY),this._enemy._svEnemySS6Player=new G(e,s,a),this._enemy._svEnemySS6Player.loop=-1,this._enemy._svEnemySS6Player.SetPlayEndCallback(l=>{}),this._enemy._svEnemySS6Player.scale.x=c,this._enemy._svEnemySS6Player.scale.y=n,this._enemy._svEnemySS6Player.position.x+=h,this._enemy._svEnemySS6Player.position.y+=r,this._enemy._svEnemySS6Player.Play(),this.addChild(this._enemy._svEnemySS6Player),this._enemy._svEnemySS6PlayerParent=this}};const Mt=Sprite_Enemy.prototype.updateFrame;Sprite_Enemy.prototype.updateFrame=function(){if(E.getInstance().replaceSVEnemySpriteFlag){const i=this._enemy.enemyId(),t=Sprite_Enemy.svEnemySsfbId(i);if(!this._enemy._svEnemySS6ProjectLoaded)return;if(y.getInstance().isExist(t)&&this._enemy._svEnemySS6Player!==void 0){if(this.bitmap){Mt.call(this);return}Sprite_Battler.prototype.updateFrame.call(this);const s=this._enemy._svEnemySS6Player;let a=0,c=0;s&&(a=s.width,c=s.height),this._effectType==="bossCollapse"?this.setFrame(0,0,a,this._effectDuration):this.setFrame(0,0,a,c)}else Mt.call(this)}else Mt.call(this)};const Ie=Sprite_Enemy.prototype.updateStateSprite;Sprite_Enemy.prototype.updateStateSprite=function(){if(E.getInstance().replaceSVEnemySpriteFlag)if(this.bitmap)this._stateIconSprite.y=-Math.round((this.bitmap.height+40)*.9),this._stateIconSprite.y<20-this.y&&(this._stateIconSprite.y=20-this.y);else{let i=0;this._enemy&&this._enemy._svEnemySS6Player&&(i=this._enemy._svEnemySS6Player),this._stateIconSprite.y=-Math.round((i+40)*.9),this._stateIconSprite.y<20-this.y&&(this._stateIconSprite.y=20-this.y)}else Ie.call(this)}}(PIXI,PIXI,PIXI,PIXI,PIXI.filters,PIXI);
