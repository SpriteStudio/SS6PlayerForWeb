/**
 * -----------------------------------------------------------
 * SS6Player For RPG Maker MZ v0.8.2
 *
 * Copyright(C) CRI Middleware Co., Ltd.
 * https://www.webtech.co.jp/
 * -----------------------------------------------------------
 */

// eslint-disable-next-line
var Imported = Imported || {};
Imported.SS6PlayerRPGMakerMZ = true;

/*:ja
 * @target MZ
 * @plugindesc SpriteStudio 7.0 & 6 アニメーション再生プラグイン
 * @version 0.8.2
 * @author CRI Middleware Co., Ltd.
 * @url https://github.com/SpriteStudio/SS6PlayerForWeb/tree/master/packages/ss6player-rpgmakermz
 * @help SS6Player for RPG Maker MZ
 *
 * 詳しい使い方は、GitHub リポジトリの README.md をお読みください。
 * https://github.com/SpriteStudio/SS6PlayerForWeb/tree/master/packages/ss6player-rpgmakermz/README.md
 *
 * デプロイメント時に「未使用ファイルを削除」オプションを使用した場合、
 * アニメーションを含むフォルダは削除されてしまいます。
 * 必ず、デプロイメント後にプラグインパラメータで指定したディレクトリを、
 * 出力先の同じ位置にコピーしてください。
 *
 * @param animationDir
 * @text ssfb アニメーションベースディレクトリ
 * @desc ssfb のフォルダを格納するベースディレクトリのパスです。
 * @type file
 * @default img/ssfb
 * @requiredAssets img/ssfb
 *
 * @param replaceSVActorSpriteFlag
 * @text SV アクター置き換え
 * @desc SV アクターを Sprite Studio アニメーションに置き換える機能の ON/OFF です。
 * @type boolean
 * @default false
 *
 * @param svActorDir
 * @text SV アクターディレクトリ
 * @desc SV アクターの SpriteStudio データを格納するディレクトリのパスです
 * @type file
 * @default img/ssfb/sv_actors
 * @requiredAssets img/ssfb/sv_actors
 *
 * @param svActorAnimationPack
 * @text SV アクターアニメーションパック名
 * @desc SV アクターが利用する Sprite Studio の共通アニメーションパック(ssae)名です
 * @type string
 * @default motions
 *
 * @param svActorHideWeaponGraphics
 * @text SV アクター武器非表示
 * @desc SV アクターの攻撃中の武器アニメーションを非表示にする機能の ON/OFF です。
 * @type boolean
 * @default true
 *
 * @param replaceSVEnemySpriteFlag
 * @text SV エネミー置き換え
 * @desc SV エネミーを Sprite Studio アニメーションに置き換える機能の ON/OFF です。
 * @type boolean
 * @default false
 *
 * @param svEnemyDir
 * @text SV エネミーディレクトリ
 * @desc SV アクターの SpriteStudio データを格納するディレクトリのパスです
 * @type file
 * @default img/ssfb/sv_enemies
 * @requiredAssets img/ssfb/sv_enemies
 *
 * @param svEnemyAnimationPack
 * @text SV エネミーアニメーションパック名
 * @desc SV エネミーが利用する Sprite Studio の共通アニメーションパック(ssae)名です
 * @type string
 * @default motions
 *
 * @param svEnemyAnimationName
 * @text SV エネミーアニメーション名
 * @desc SV エネミーが利用する Sprite Studio の共通アニメーション名です。
 * @type string
 * @default walk
 *
 *
 * @command loadSsfb
 * @text ssfbロード
 * @desc ssfb ファイルと関連画像をダウンロードしロードします。
 *
 * @arg ssfbId
 * @text ssfb ID
 * @desc 登録する ssfb ID です。他のコマンドから参照するのに利用します。
 * @type number
 * @min 1
 *
 * @arg ssfbFile
 * @text ssfbファイルパス
 * @desc ssfb ファイルをアニメーションディレクトリからの相対パスで指定してください。 (e.g. MeshBone/Knight.ssfb)
 * @type string
 *
 *
 * @command setAsPicture
 * @text アニメーションピクチャの設定
 * @desc ピクチャとして表示するアニメーションを設定します。
 *       この後、画像を指定せずに「ピクチャの表示」を実行してください。
 *
 * @arg ssfbId
 * @text ssfb ID
 * @desc 利用する ssfb ID を指定してください。
 * @type number
 * @min 1
 *
 * @arg animePackName
 * @text アニメパック名
 * @desc 再生するアニメパック名(ssae)を指定してください。
 *       e.g. Knight_bomb
 * @type string
 *
 * @arg animeName
 * @text アニメ名
 * @desc 再生するアニメ名を指定してください。
 *       e.g. Balloon
 * @type string
 *
 * @arg scaleX
 * @text スケールX
 * @desc X のスケールを指定します
 * @type decimals
 * @default 1.0
 *
 * @arg scaleY
 * @text スケールY
 * @desc Y のスケールを指定します
 * @type decimals
 * @default 1.0
 *
 * @arg loop
 * @text 再生ループ回数
 * @desc 再生ループ回数を指定します。 -1 を指定すると無限ループで再生します。
 * @type number
 * @default 1
 * @min -1
 *
 *
 * @command waitForPicture
 * @text ピクチャ再生待ち
 * @desc アニメーションが再生完了するまでウエイトします。ピクチャにアニメーションがない場合とループ再生時は無視されます。
 *
 * @arg pictureId
 * @text Picture ID
 * @desc アニメーション再生中のピクチャの ID を指定してください。
 * @type number
 * @min 1
 *
 */

var Imported=Imported||{};Imported.SS6PlayerRPGMakerMZ=!0,function(Jt,Nt,ht,gt,wt,k){"use strict";class Gt{}const pt=4,ut=4,O=4,st=new Int32Array(2),At=new Float32Array(st.buffer),kt=new Float64Array(st.buffer),mt=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Ft;(function(i){i[i.UTF8_BYTES=1]="UTF8_BYTES",i[i.UTF16_STRING=2]="UTF16_STRING"})(Ft||(Ft={}));class vt{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new vt(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return st[0]=this.readInt32(t),At[0]}readFloat64(t){return st[mt?0:1]=this.readInt32(t),st[mt?1:0]=this.readInt32(t+4),kt[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){At[0]=e,this.writeInt32(t,st[0])}writeFloat64(t,e){kt[0]=e,this.writeInt32(t,st[mt?0:1]),this.writeInt32(t+4,st[mt?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+pt+ut)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<ut;e++)t+=String.fromCharCode(this.readInt8(this.position_+pt+e));return t}__offset(t,e){const s=t-this.readInt32(t);return e<this.readInt16(s)?this.readInt16(s+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const s=this.readInt32(t);t+=pt;const a=this.bytes_.subarray(t,t+s);return e===Ft.UTF8_BYTES?a:this.text_decoder_.decode(a)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+pt}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=ut)throw new Error("FlatBuffers: file identifier must be length "+ut);for(let e=0;e<ut;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+pt+e))return!1;return!0}createScalarList(t,e){const s=[];for(let a=0;a<e;++a){const o=t(a);o!==null&&s.push(o)}return s}createObjList(t,e){const s=[];for(let a=0;a<e;++a){const o=t(a);o!==null&&s.push(o.unpack())}return s}}class b{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAnimationInitialData(t,e){return(e||new b).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAnimationInitialData(t,e){return t.setPosition(t.position()+O),(e||new b).__init(t.readInt32(t.position())+t.position(),t)}index(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}lowflag(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}highflag(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):0}priority(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}cellIndex(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}opacity(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}localopacity(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt16(this.bb_pos+t):0}masklimen(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readInt16(this.bb_pos+t):0}positionX(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb_pos+t):0}positionY(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readFloat32(this.bb_pos+t):0}positionZ(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readFloat32(this.bb_pos+t):0}pivotX(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readFloat32(this.bb_pos+t):0}pivotY(){const t=this.bb.__offset(this.bb_pos,28);return t?this.bb.readFloat32(this.bb_pos+t):0}rotationX(){const t=this.bb.__offset(this.bb_pos,30);return t?this.bb.readFloat32(this.bb_pos+t):0}rotationY(){const t=this.bb.__offset(this.bb_pos,32);return t?this.bb.readFloat32(this.bb_pos+t):0}rotationZ(){const t=this.bb.__offset(this.bb_pos,34);return t?this.bb.readFloat32(this.bb_pos+t):0}scaleX(){const t=this.bb.__offset(this.bb_pos,36);return t?this.bb.readFloat32(this.bb_pos+t):0}scaleY(){const t=this.bb.__offset(this.bb_pos,38);return t?this.bb.readFloat32(this.bb_pos+t):0}localscaleX(){const t=this.bb.__offset(this.bb_pos,40);return t?this.bb.readFloat32(this.bb_pos+t):0}localscaleY(){const t=this.bb.__offset(this.bb_pos,42);return t?this.bb.readFloat32(this.bb_pos+t):0}sizeX(){const t=this.bb.__offset(this.bb_pos,44);return t?this.bb.readFloat32(this.bb_pos+t):0}sizeY(){const t=this.bb.__offset(this.bb_pos,46);return t?this.bb.readFloat32(this.bb_pos+t):0}uvMoveX(){const t=this.bb.__offset(this.bb_pos,48);return t?this.bb.readFloat32(this.bb_pos+t):0}uvMoveY(){const t=this.bb.__offset(this.bb_pos,50);return t?this.bb.readFloat32(this.bb_pos+t):0}uvRotation(){const t=this.bb.__offset(this.bb_pos,52);return t?this.bb.readFloat32(this.bb_pos+t):0}uvScaleX(){const t=this.bb.__offset(this.bb_pos,54);return t?this.bb.readFloat32(this.bb_pos+t):0}uvScaleY(){const t=this.bb.__offset(this.bb_pos,56);return t?this.bb.readFloat32(this.bb_pos+t):0}boundingRadius(){const t=this.bb.__offset(this.bb_pos,58);return t?this.bb.readFloat32(this.bb_pos+t):0}instanceValueCurKeyframe(){const t=this.bb.__offset(this.bb_pos,60);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueStartFrame(){const t=this.bb.__offset(this.bb_pos,62);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueEndFrame(){const t=this.bb.__offset(this.bb_pos,64);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueLoopNum(){const t=this.bb.__offset(this.bb_pos,66);return t?this.bb.readInt32(this.bb_pos+t):0}instanceValueSpeed(){const t=this.bb.__offset(this.bb_pos,68);return t?this.bb.readFloat32(this.bb_pos+t):0}instanceValueLoopflag(){const t=this.bb.__offset(this.bb_pos,70);return t?this.bb.readInt32(this.bb_pos+t):0}effectValueCurKeyframe(){const t=this.bb.__offset(this.bb_pos,72);return t?this.bb.readInt32(this.bb_pos+t):0}effectValueStartTime(){const t=this.bb.__offset(this.bb_pos,74);return t?this.bb.readInt32(this.bb_pos+t):0}effectValueSpeed(){const t=this.bb.__offset(this.bb_pos,76);return t?this.bb.readFloat32(this.bb_pos+t):0}effectValueLoopflag(){const t=this.bb.__offset(this.bb_pos,78);return t?this.bb.readInt32(this.bb_pos+t):0}static startAnimationInitialData(t){t.startObject(38)}static addIndex(t,e){t.addFieldInt16(0,e,0)}static addLowflag(t,e){t.addFieldInt32(1,e,0)}static addHighflag(t,e){t.addFieldInt32(2,e,0)}static addPriority(t,e){t.addFieldInt16(3,e,0)}static addCellIndex(t,e){t.addFieldInt16(4,e,0)}static addOpacity(t,e){t.addFieldInt16(5,e,0)}static addLocalopacity(t,e){t.addFieldInt16(6,e,0)}static addMasklimen(t,e){t.addFieldInt16(7,e,0)}static addPositionX(t,e){t.addFieldFloat32(8,e,0)}static addPositionY(t,e){t.addFieldFloat32(9,e,0)}static addPositionZ(t,e){t.addFieldFloat32(10,e,0)}static addPivotX(t,e){t.addFieldFloat32(11,e,0)}static addPivotY(t,e){t.addFieldFloat32(12,e,0)}static addRotationX(t,e){t.addFieldFloat32(13,e,0)}static addRotationY(t,e){t.addFieldFloat32(14,e,0)}static addRotationZ(t,e){t.addFieldFloat32(15,e,0)}static addScaleX(t,e){t.addFieldFloat32(16,e,0)}static addScaleY(t,e){t.addFieldFloat32(17,e,0)}static addLocalscaleX(t,e){t.addFieldFloat32(18,e,0)}static addLocalscaleY(t,e){t.addFieldFloat32(19,e,0)}static addSizeX(t,e){t.addFieldFloat32(20,e,0)}static addSizeY(t,e){t.addFieldFloat32(21,e,0)}static addUvMoveX(t,e){t.addFieldFloat32(22,e,0)}static addUvMoveY(t,e){t.addFieldFloat32(23,e,0)}static addUvRotation(t,e){t.addFieldFloat32(24,e,0)}static addUvScaleX(t,e){t.addFieldFloat32(25,e,0)}static addUvScaleY(t,e){t.addFieldFloat32(26,e,0)}static addBoundingRadius(t,e){t.addFieldFloat32(27,e,0)}static addInstanceValueCurKeyframe(t,e){t.addFieldInt32(28,e,0)}static addInstanceValueStartFrame(t,e){t.addFieldInt32(29,e,0)}static addInstanceValueEndFrame(t,e){t.addFieldInt32(30,e,0)}static addInstanceValueLoopNum(t,e){t.addFieldInt32(31,e,0)}static addInstanceValueSpeed(t,e){t.addFieldFloat32(32,e,0)}static addInstanceValueLoopflag(t,e){t.addFieldInt32(33,e,0)}static addEffectValueCurKeyframe(t,e){t.addFieldInt32(34,e,0)}static addEffectValueStartTime(t,e){t.addFieldInt32(35,e,0)}static addEffectValueSpeed(t,e){t.addFieldFloat32(36,e,0)}static addEffectValueLoopflag(t,e){t.addFieldInt32(37,e,0)}static endAnimationInitialData(t){return t.endObject()}static createAnimationInitialData(t,e,s,a,o,n,c,r,l,h,d,u,f,_,v,S,y,m,Z,G,nt,Y,P,T,q,Q,L,N,w,U,tt,I,j,A,z,et,K,dt,ft){return b.startAnimationInitialData(t),b.addIndex(t,e),b.addLowflag(t,s),b.addHighflag(t,a),b.addPriority(t,o),b.addCellIndex(t,n),b.addOpacity(t,c),b.addLocalopacity(t,r),b.addMasklimen(t,l),b.addPositionX(t,h),b.addPositionY(t,d),b.addPositionZ(t,u),b.addPivotX(t,f),b.addPivotY(t,_),b.addRotationX(t,v),b.addRotationY(t,S),b.addRotationZ(t,y),b.addScaleX(t,m),b.addScaleY(t,Z),b.addLocalscaleX(t,G),b.addLocalscaleY(t,nt),b.addSizeX(t,Y),b.addSizeY(t,P),b.addUvMoveX(t,T),b.addUvMoveY(t,q),b.addUvRotation(t,Q),b.addUvScaleX(t,L),b.addUvScaleY(t,N),b.addBoundingRadius(t,w),b.addInstanceValueCurKeyframe(t,U),b.addInstanceValueStartFrame(t,tt),b.addInstanceValueEndFrame(t,I),b.addInstanceValueLoopNum(t,j),b.addInstanceValueSpeed(t,A),b.addInstanceValueLoopflag(t,z),b.addEffectValueCurKeyframe(t,et),b.addEffectValueStartTime(t,K),b.addEffectValueSpeed(t,dt),b.addEffectValueLoopflag(t,ft),b.endAnimationInitialData(t)}}class R{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAspartState(t,e){return(e||new R).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAspartState(t,e){return t.setPosition(t.position()+O),(e||new R).__init(t.readInt32(t.position())+t.position(),t)}index(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}flag1(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint32(this.bb_pos+t):0}flag2(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint32(this.bb_pos+t):0}data(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}dataLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}dataArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startpartState(t){t.startObject(4)}static addIndex(t,e){t.addFieldInt16(0,e,0)}static addFlag1(t,e){t.addFieldInt32(1,e,0)}static addFlag2(t,e){t.addFieldInt32(2,e,0)}static addData(t,e){t.addFieldOffset(3,e,0)}static createDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addInt32(e[s]);return t.endVector()}static startDataVector(t,e){t.startVector(4,e,4)}static endpartState(t){return t.endObject()}static createpartState(t,e,s,a,o){return R.startpartState(t),R.addIndex(t,e),R.addFlag1(t,s),R.addFlag2(t,a),R.addData(t,o),R.endpartState(t)}}class ot{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsframeDataIndex(t,e){return(e||new ot).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsframeDataIndex(t,e){return t.setPosition(t.position()+O),(e||new ot).__init(t.readInt32(t.position())+t.position(),t)}states(t,e){const s=this.bb.__offset(this.bb_pos,4);return s?(e||new R).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}statesLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}static startframeDataIndex(t){t.startObject(1)}static addStates(t,e){t.addFieldOffset(0,e,0)}static createStatesVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startStatesVector(t,e){t.startVector(4,e,4)}static endframeDataIndex(t){return t.endObject()}static createframeDataIndex(t,e){return ot.startframeDataIndex(t),ot.addStates(t,e),ot.endframeDataIndex(t)}}class it{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAslabelDataItem(t,e){return(e||new it).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAslabelDataItem(t,e){return t.setPosition(t.position()+O),(e||new it).__init(t.readInt32(t.position())+t.position(),t)}label(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}frameIndex(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}static startlabelDataItem(t){t.startObject(2)}static addLabel(t,e){t.addFieldOffset(0,e,0)}static addFrameIndex(t,e){t.addFieldInt16(1,e,0)}static endlabelDataItem(t){return t.endObject()}static createlabelDataItem(t,e,s){return it.startlabelDataItem(t),it.addLabel(t,e),it.addFrameIndex(t,s),it.endlabelDataItem(t)}}class rt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsmeshDataIndices(t,e){return(e||new rt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsmeshDataIndices(t,e){return t.setPosition(t.position()+O),(e||new rt).__init(t.readInt32(t.position())+t.position(),t)}indices(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}indicesLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}indicesArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startmeshDataIndices(t){t.startObject(1)}static addIndices(t,e){t.addFieldOffset(0,e,0)}static createIndicesVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addFloat32(e[s]);return t.endVector()}static startIndicesVector(t,e){t.startVector(4,e,4)}static endmeshDataIndices(t){return t.endObject()}static createmeshDataIndices(t,e){return rt.startmeshDataIndices(t),rt.addIndices(t,e),rt.endmeshDataIndices(t)}}class ct{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsmeshDataUV(t,e){return(e||new ct).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsmeshDataUV(t,e){return t.setPosition(t.position()+O),(e||new ct).__init(t.readInt32(t.position())+t.position(),t)}uv(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}uvLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}uvArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startmeshDataUV(t){t.startObject(1)}static addUv(t,e){t.addFieldOffset(0,e,0)}static createUvVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addFloat32(e[s]);return t.endVector()}static startUvVector(t,e){t.startVector(4,e,4)}static endmeshDataUV(t){return t.endObject()}static createmeshDataUV(t,e){return ct.startmeshDataUV(t),ct.addUv(t,e),ct.endmeshDataUV(t)}}class W{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsuserDataItem(t,e){return(e||new W).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsuserDataItem(t,e){return t.setPosition(t.position()+O),(e||new W).__init(t.readInt32(t.position())+t.position(),t)}flags(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}arrayIndex(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}dataType(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}dataTypeLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}dataTypeArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}data(t,e){const s=this.bb.__offset(this.bb_pos,10);return s?this.bb.__union(e,this.bb.__vector(this.bb_pos+s)+t*4):null}dataLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startuserDataItem(t){t.startObject(4)}static addFlags(t,e){t.addFieldInt16(0,e,0)}static addArrayIndex(t,e){t.addFieldInt16(1,e,0)}static addDataType(t,e){t.addFieldOffset(2,e,0)}static createDataTypeVector(t,e){t.startVector(1,e.length,1);for(let s=e.length-1;s>=0;s--)t.addInt8(e[s]);return t.endVector()}static startDataTypeVector(t,e){t.startVector(1,e,1)}static addData(t,e){t.addFieldOffset(3,e,0)}static createDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startDataVector(t,e){t.startVector(4,e,4)}static enduserDataItem(t){return t.endObject()}static createuserDataItem(t,e,s,a,o){return W.startuserDataItem(t),W.addFlags(t,e),W.addArrayIndex(t,s),W.addDataType(t,a),W.addData(t,o),W.enduserDataItem(t)}}class at{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsuserDataPerFrame(t,e){return(e||new at).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsuserDataPerFrame(t,e){return t.setPosition(t.position()+O),(e||new at).__init(t.readInt32(t.position())+t.position(),t)}frameIndex(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}data(t,e){const s=this.bb.__offset(this.bb_pos,6);return s?(e||new W).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}dataLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}static startuserDataPerFrame(t){t.startObject(2)}static addFrameIndex(t,e){t.addFieldInt16(0,e,0)}static addData(t,e){t.addFieldOffset(1,e,0)}static createDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startDataVector(t,e){t.startVector(4,e,4)}static enduserDataPerFrame(t){return t.endObject()}static createuserDataPerFrame(t,e,s){return at.startuserDataPerFrame(t),at.addFrameIndex(t,e),at.addData(t,s),at.enduserDataPerFrame(t)}}class g{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAnimationData(t,e){return(e||new g).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAnimationData(t,e){return t.setPosition(t.position()+O),(e||new g).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}defaultData(t,e){const s=this.bb.__offset(this.bb_pos,6);return s?(e||new b).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}defaultDataLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}frameData(t,e){const s=this.bb.__offset(this.bb_pos,8);return s?(e||new ot).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}frameDataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}userData(t,e){const s=this.bb.__offset(this.bb_pos,10);return s?(e||new at).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}userDataLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}labelData(t,e){const s=this.bb.__offset(this.bb_pos,12);return s?(e||new it).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}labelDataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}meshsDataUv(t,e){const s=this.bb.__offset(this.bb_pos,14);return s?(e||new ct).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}meshsDataUvLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}meshsDataIndices(t,e){const s=this.bb.__offset(this.bb_pos,16);return s?(e||new rt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}meshsDataIndicesLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}startFrames(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readInt16(this.bb_pos+t):0}endFrames(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readInt16(this.bb_pos+t):0}totalFrames(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt16(this.bb_pos+t):0}fps(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readInt16(this.bb_pos+t):0}labelNum(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt16(this.bb_pos+t):0}canvasSizeW(){const t=this.bb.__offset(this.bb_pos,28);return t?this.bb.readInt16(this.bb_pos+t):0}canvasSizeH(){const t=this.bb.__offset(this.bb_pos,30);return t?this.bb.readInt16(this.bb_pos+t):0}canvasPvotX(){const t=this.bb.__offset(this.bb_pos,32);return t?this.bb.readFloat32(this.bb_pos+t):0}canvasPvotY(){const t=this.bb.__offset(this.bb_pos,34);return t?this.bb.readFloat32(this.bb_pos+t):0}static startAnimationData(t){t.startObject(16)}static addName(t,e){t.addFieldOffset(0,e,0)}static addDefaultData(t,e){t.addFieldOffset(1,e,0)}static createDefaultDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startDefaultDataVector(t,e){t.startVector(4,e,4)}static addFrameData(t,e){t.addFieldOffset(2,e,0)}static createFrameDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startFrameDataVector(t,e){t.startVector(4,e,4)}static addUserData(t,e){t.addFieldOffset(3,e,0)}static createUserDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startUserDataVector(t,e){t.startVector(4,e,4)}static addLabelData(t,e){t.addFieldOffset(4,e,0)}static createLabelDataVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startLabelDataVector(t,e){t.startVector(4,e,4)}static addMeshsDataUv(t,e){t.addFieldOffset(5,e,0)}static createMeshsDataUvVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startMeshsDataUvVector(t,e){t.startVector(4,e,4)}static addMeshsDataIndices(t,e){t.addFieldOffset(6,e,0)}static createMeshsDataIndicesVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startMeshsDataIndicesVector(t,e){t.startVector(4,e,4)}static addStartFrames(t,e){t.addFieldInt16(7,e,0)}static addEndFrames(t,e){t.addFieldInt16(8,e,0)}static addTotalFrames(t,e){t.addFieldInt16(9,e,0)}static addFps(t,e){t.addFieldInt16(10,e,0)}static addLabelNum(t,e){t.addFieldInt16(11,e,0)}static addCanvasSizeW(t,e){t.addFieldInt16(12,e,0)}static addCanvasSizeH(t,e){t.addFieldInt16(13,e,0)}static addCanvasPvotX(t,e){t.addFieldFloat32(14,e,0)}static addCanvasPvotY(t,e){t.addFieldFloat32(15,e,0)}static endAnimationData(t){return t.endObject()}static createAnimationData(t,e,s,a,o,n,c,r,l,h,d,u,f,_,v,S,y){return g.startAnimationData(t),g.addName(t,e),g.addDefaultData(t,s),g.addFrameData(t,a),g.addUserData(t,o),g.addLabelData(t,n),g.addMeshsDataUv(t,c),g.addMeshsDataIndices(t,r),g.addStartFrames(t,l),g.addEndFrames(t,h),g.addTotalFrames(t,d),g.addFps(t,u),g.addLabelNum(t,f),g.addCanvasSizeW(t,_),g.addCanvasSizeH(t,v),g.addCanvasPvotX(t,S),g.addCanvasPvotY(t,y),g.endAnimationData(t)}}var E=(i=>(i[i.Invalid=-1]="Invalid",i[i.Nulltype=0]="Nulltype",i[i.Normal=1]="Normal",i[i.Text=2]="Text",i[i.Instance=3]="Instance",i[i.Armature=4]="Armature",i[i.Effect=5]="Effect",i[i.Mesh=6]="Mesh",i[i.Movenode=7]="Movenode",i[i.Constraint=8]="Constraint",i[i.Mask=9]="Mask",i[i.Joint=10]="Joint",i[i.Bonepoint=11]="Bonepoint",i))(E||{});class M{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsPartData(t,e){return(e||new M).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsPartData(t,e){return t.setPosition(t.position()+O),(e||new M).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}index(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}parentIndex(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt8(this.bb_pos+t):E.Nulltype}boundsType(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}alphaBlendType(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}refname(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__string(this.bb_pos+e,t):null}effectfilename(t){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__string(this.bb_pos+e,t):null}colorLabel(t){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__string(this.bb_pos+e,t):null}maskInfluence(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt16(this.bb_pos+t):0}static startPartData(t){t.startObject(10)}static addName(t,e){t.addFieldOffset(0,e,0)}static addIndex(t,e){t.addFieldInt16(1,e,0)}static addParentIndex(t,e){t.addFieldInt16(2,e,0)}static addType(t,e){t.addFieldInt8(3,e,E.Nulltype)}static addBoundsType(t,e){t.addFieldInt16(4,e,0)}static addAlphaBlendType(t,e){t.addFieldInt16(5,e,0)}static addRefname(t,e){t.addFieldOffset(6,e,0)}static addEffectfilename(t,e){t.addFieldOffset(7,e,0)}static addColorLabel(t,e){t.addFieldOffset(8,e,0)}static addMaskInfluence(t,e){t.addFieldInt16(9,e,0)}static endPartData(t){return t.endObject()}static createPartData(t,e,s,a,o,n,c,r,l,h,d){return M.startPartData(t),M.addName(t,e),M.addIndex(t,s),M.addParentIndex(t,a),M.addType(t,o),M.addBoundsType(t,n),M.addAlphaBlendType(t,c),M.addRefname(t,r),M.addEffectfilename(t,l),M.addColorLabel(t,h),M.addMaskInfluence(t,d),M.endPartData(t)}}class H{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAnimePackData(t,e){return(e||new H).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAnimePackData(t,e){return t.setPosition(t.position()+O),(e||new H).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}parts(t,e){const s=this.bb.__offset(this.bb_pos,6);return s?(e||new M).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}partsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}animations(t,e){const s=this.bb.__offset(this.bb_pos,8);return s?(e||new g).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}animationsLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startAnimePackData(t){t.startObject(3)}static addName(t,e){t.addFieldOffset(0,e,0)}static addParts(t,e){t.addFieldOffset(1,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static addAnimations(t,e){t.addFieldOffset(2,e,0)}static createAnimationsVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startAnimationsVector(t,e){t.startVector(4,e,4)}static endAnimePackData(t){return t.endObject()}static createAnimePackData(t,e,s,a){return H.startAnimePackData(t),H.addName(t,e),H.addParts(t,s),H.addAnimations(t,a),H.endAnimePackData(t)}}class B{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCellMap(t,e){return(e||new B).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCellMap(t,e){return t.setPosition(t.position()+O),(e||new B).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}imagePath(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}index(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}wrapmode(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}filtermode(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}static startCellMap(t){t.startObject(5)}static addName(t,e){t.addFieldOffset(0,e,0)}static addImagePath(t,e){t.addFieldOffset(1,e,0)}static addIndex(t,e){t.addFieldInt16(2,e,0)}static addWrapmode(t,e){t.addFieldInt16(3,e,0)}static addFiltermode(t,e){t.addFieldInt16(4,e,0)}static endCellMap(t){return t.endObject()}static createCellMap(t,e,s,a,o,n){return B.startCellMap(t),B.addName(t,e),B.addImagePath(t,s),B.addIndex(t,a),B.addWrapmode(t,o),B.addFiltermode(t,n),B.endCellMap(t)}}class St{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCell(t,e){return(e||new St).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCell(t,e){return t.setPosition(t.position()+O),(e||new St).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}cellMap(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new B).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}indexInCellMap(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}x(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}y(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}width(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}height(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt16(this.bb_pos+t):0}pivotX(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readFloat32(this.bb_pos+t):0}pivotY(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb_pos+t):0}u1(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readFloat32(this.bb_pos+t):0}v1(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readFloat32(this.bb_pos+t):0}u2(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readFloat32(this.bb_pos+t):0}v2(){const t=this.bb.__offset(this.bb_pos,28);return t?this.bb.readFloat32(this.bb_pos+t):0}static startCell(t){t.startObject(13)}static addName(t,e){t.addFieldOffset(0,e,0)}static addCellMap(t,e){t.addFieldOffset(1,e,0)}static addIndexInCellMap(t,e){t.addFieldInt16(2,e,0)}static addX(t,e){t.addFieldInt16(3,e,0)}static addY(t,e){t.addFieldInt16(4,e,0)}static addWidth(t,e){t.addFieldInt16(5,e,0)}static addHeight(t,e){t.addFieldInt16(6,e,0)}static addPivotX(t,e){t.addFieldFloat32(7,e,0)}static addPivotY(t,e){t.addFieldFloat32(8,e,0)}static addU1(t,e){t.addFieldFloat32(9,e,0)}static addV1(t,e){t.addFieldFloat32(10,e,0)}static addU2(t,e){t.addFieldFloat32(11,e,0)}static addV2(t,e){t.addFieldFloat32(12,e,0)}static endCell(t){return t.endObject()}}class D{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsEffectNode(t,e){return(e||new D).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsEffectNode(t,e){return t.setPosition(t.position()+O),(e||new D).__init(t.readInt32(t.position())+t.position(),t)}arrayIndex(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):0}parentIndex(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}cellIndex(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}blendType(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}numBehavior(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}behaviorType(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}behaviorTypeLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}behaviorTypeArray(){const t=this.bb.__offset(this.bb_pos,16);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}behavior(t,e){const s=this.bb.__offset(this.bb_pos,18);return s?this.bb.__union(e,this.bb.__vector(this.bb_pos+s)+t*4):null}behaviorLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startEffectNode(t){t.startObject(8)}static addArrayIndex(t,e){t.addFieldInt16(0,e,0)}static addParentIndex(t,e){t.addFieldInt16(1,e,0)}static addType(t,e){t.addFieldInt16(2,e,0)}static addCellIndex(t,e){t.addFieldInt16(3,e,0)}static addBlendType(t,e){t.addFieldInt16(4,e,0)}static addNumBehavior(t,e){t.addFieldInt16(5,e,0)}static addBehaviorType(t,e){t.addFieldOffset(6,e,0)}static createBehaviorTypeVector(t,e){t.startVector(1,e.length,1);for(let s=e.length-1;s>=0;s--)t.addInt8(e[s]);return t.endVector()}static startBehaviorTypeVector(t,e){t.startVector(1,e,1)}static addBehavior(t,e){t.addFieldOffset(7,e,0)}static createBehaviorVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startBehaviorVector(t,e){t.startVector(4,e,4)}static endEffectNode(t){return t.endObject()}static createEffectNode(t,e,s,a,o,n,c,r,l){return D.startEffectNode(t),D.addArrayIndex(t,e),D.addParentIndex(t,s),D.addType(t,a),D.addCellIndex(t,o),D.addBlendType(t,n),D.addNumBehavior(t,c),D.addBehaviorType(t,r),D.addBehavior(t,l),D.endEffectNode(t)}}class x{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsEffectFile(t,e){return(e||new x).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsEffectFile(t,e){return t.setPosition(t.position()+O),(e||new x).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}fps(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt16(this.bb_pos+t):0}isLockRandSeed(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt16(this.bb_pos+t):0}lockRandSeed(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):0}layoutScaleX(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt16(this.bb_pos+t):0}layoutScaleY(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}numNodeList(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt16(this.bb_pos+t):0}effectNode(t,e){const s=this.bb.__offset(this.bb_pos,18);return s?(e||new D).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}effectNodeLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startEffectFile(t){t.startObject(8)}static addName(t,e){t.addFieldOffset(0,e,0)}static addFps(t,e){t.addFieldInt16(1,e,0)}static addIsLockRandSeed(t,e){t.addFieldInt16(2,e,0)}static addLockRandSeed(t,e){t.addFieldInt16(3,e,0)}static addLayoutScaleX(t,e){t.addFieldInt16(4,e,0)}static addLayoutScaleY(t,e){t.addFieldInt16(5,e,0)}static addNumNodeList(t,e){t.addFieldInt16(6,e,0)}static addEffectNode(t,e){t.addFieldOffset(7,e,0)}static createEffectNodeVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startEffectNodeVector(t,e){t.startVector(4,e,4)}static endEffectFile(t){return t.endObject()}static createEffectFile(t,e,s,a,o,n,c,r,l){return x.startEffectFile(t),x.addName(t,e),x.addFps(t,s),x.addIsLockRandSeed(t,a),x.addLockRandSeed(t,o),x.addLayoutScaleX(t,n),x.addLayoutScaleY(t,c),x.addNumNodeList(t,r),x.addEffectNode(t,l),x.endEffectFile(t)}}var p=(i=>(i[i.INVISIBLE=1]="INVISIBLE",i[i.FLIP_H=2]="FLIP_H",i[i.FLIP_V=4]="FLIP_V",i[i.CELL_INDEX=8]="CELL_INDEX",i[i.POSITION_X=16]="POSITION_X",i[i.POSITION_Y=32]="POSITION_Y",i[i.POSITION_Z=64]="POSITION_Z",i[i.PIVOT_X=128]="PIVOT_X",i[i.PIVOT_Y=256]="PIVOT_Y",i[i.ROTATIONX=512]="ROTATIONX",i[i.ROTATIONY=1024]="ROTATIONY",i[i.ROTATIONZ=2048]="ROTATIONZ",i[i.SCALE_X=4096]="SCALE_X",i[i.SCALE_Y=8192]="SCALE_Y",i[i.LOCALSCALE_X=16384]="LOCALSCALE_X",i[i.LOCALSCALE_Y=32768]="LOCALSCALE_Y",i[i.OPACITY=65536]="OPACITY",i[i.LOCALOPACITY=131072]="LOCALOPACITY",i[i.PARTS_COLOR=262144]="PARTS_COLOR",i[i.VERTEX_TRANSFORM=524288]="VERTEX_TRANSFORM",i[i.SIZE_X=1048576]="SIZE_X",i[i.SIZE_Y=2097152]="SIZE_Y",i[i.U_MOVE=4194304]="U_MOVE",i[i.V_MOVE=8388608]="V_MOVE",i[i.UV_ROTATION=16777216]="UV_ROTATION",i[i.U_SCALE=33554432]="U_SCALE",i[i.V_SCALE=67108864]="V_SCALE",i[i.BOUNDINGRADIUS=134217728]="BOUNDINGRADIUS",i[i.MASK=268435456]="MASK",i[i.PRIORITY=536870912]="PRIORITY",i[i.INSTANCE_KEYFRAME=1073741824]="INSTANCE_KEYFRAME",i[i.EFFECT_KEYFRAME=2147483648]="EFFECT_KEYFRAME",i))(p||{}),Yt=(i=>(i[i.MESHDATA=1]="MESHDATA",i))(Yt||{});class C{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsProjectData(t,e){return(e||new C).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsProjectData(t,e){return t.setPosition(t.position()+O),(e||new C).__init(t.readInt32(t.position())+t.position(),t)}static bufferHasIdentifier(t){return t.__has_identifier("SSFB")}dataId(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb_pos+t):0}version(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint32(this.bb_pos+t):0}flags(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint32(this.bb_pos+t):0}imageBaseDir(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}cells(t,e){const s=this.bb.__offset(this.bb_pos,12);return s?(e||new St).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}cellsLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}animePacks(t,e){const s=this.bb.__offset(this.bb_pos,14);return s?(e||new H).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}animePacksLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}effectFileList(t,e){const s=this.bb.__offset(this.bb_pos,16);return s?(e||new x).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+t*4),this.bb):null}effectFileListLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}numCells(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readInt16(this.bb_pos+t):0}numAnimePacks(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readInt16(this.bb_pos+t):0}numEffectFileList(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt16(this.bb_pos+t):0}static startProjectData(t){t.startObject(10)}static addDataId(t,e){t.addFieldInt32(0,e,0)}static addVersion(t,e){t.addFieldInt32(1,e,0)}static addFlags(t,e){t.addFieldInt32(2,e,0)}static addImageBaseDir(t,e){t.addFieldOffset(3,e,0)}static addCells(t,e){t.addFieldOffset(4,e,0)}static createCellsVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startCellsVector(t,e){t.startVector(4,e,4)}static addAnimePacks(t,e){t.addFieldOffset(5,e,0)}static createAnimePacksVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startAnimePacksVector(t,e){t.startVector(4,e,4)}static addEffectFileList(t,e){t.addFieldOffset(6,e,0)}static createEffectFileListVector(t,e){t.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)t.addOffset(e[s]);return t.endVector()}static startEffectFileListVector(t,e){t.startVector(4,e,4)}static addNumCells(t,e){t.addFieldInt16(7,e,0)}static addNumAnimePacks(t,e){t.addFieldInt16(8,e,0)}static addNumEffectFileList(t,e){t.addFieldInt16(9,e,0)}static endProjectData(t){return t.endObject()}static finishProjectDataBuffer(t,e){t.finish(e,"SSFB")}static finishSizePrefixedProjectDataBuffer(t,e){t.finish(e,"SSFB",!0)}static createProjectData(t,e,s,a,o,n,c,r,l,h,d){return C.startProjectData(t),C.addDataId(t,e),C.addVersion(t,s),C.addFlags(t,a),C.addImageBaseDir(t,o),C.addCells(t,n),C.addAnimePacks(t,c),C.addEffectFileList(t,r),C.addNumCells(t,l),C.addNumAnimePacks(t,h),C.addNumEffectFileList(t,d),C.endProjectData(t)}}class qt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}integer(){return this.bb.readInt32(this.bb_pos)}static sizeOf(){return 4}static createuserDataInteger(t,e){return t.prep(4,4),t.writeInt32(e),t.offset()}}class Ut{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}x(){return this.bb.readInt32(this.bb_pos)}y(){return this.bb.readInt32(this.bb_pos+4)}static sizeOf(){return 8}static createuserDataPoint(t,e,s){return t.prep(4,8),t.writeInt32(s),t.writeInt32(e),t.offset()}}class yt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}x(){return this.bb.readInt32(this.bb_pos)}y(){return this.bb.readInt32(this.bb_pos+4)}w(){return this.bb.readInt32(this.bb_pos+8)}h(){return this.bb.readInt32(this.bb_pos+12)}static sizeOf(){return 16}static createuserDataRect(t,e,s,a,o){return t.prep(4,16),t.writeInt32(o),t.writeInt32(a),t.writeInt32(s),t.writeInt32(e),t.offset()}}class ${constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsuserDataString(t,e){return(e||new $).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsuserDataString(t,e){return t.setPosition(t.position()+O),(e||new $).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startuserDataString(t){t.startObject(2)}static addLength(t,e){t.addFieldInt32(0,e,0)}static addData(t,e){t.addFieldOffset(1,e,0)}static enduserDataString(t){return t.endObject()}static createuserDataString(t,e,s){return $.startuserDataString(t),$.addLength(t,e),$.addData(t,s),$.enduserDataString(t)}}let Qt=class{static getProjectData(t){const e=new vt(t);return C.getRootAsProjectData(e)}};class Pt{static getProjectData(t){return Qt.getProjectData(t)}}class lt{constructor(t,e=null,s=null){this.curAnimePackName=null,this.curAnimeName=null,this.curAnimation=null,this.curAnimePackData=null,this._animePackIdx=-1,this._parentIndex=[],this._prio2index=[],this.userData=[],this.frameDataCache=null,this.currentCachedFrameNumber=-1,this.defaultFrameMap=[],this._uint32=new Uint32Array(1),this._float32=new Float32Array(this._uint32.buffer),t.hasOwnProperty("bb")?this._fbObj=t:this._fbObj=Pt.getProjectData(t),e!==null&&s!==null&&this.Setup(e,s)}get fbObj(){return this._fbObj}get animePackName(){return this.curAnimePackName}get animeName(){return this.curAnimeName}get animePackIdx(){return this._animePackIdx}get animePackData(){return this.curAnimePackData}get animationData(){return this.curAnimation}get parentIndex(){return this._parentIndex}get prio2index(){return this._prio2index}Setup(t,e){this.clearCaches();const s=this._fbObj.animePacksLength();let a=!1;for(let o=0;o<s;o++)if(this._fbObj.animePacks(o).name()===t){let n;const c=this._fbObj.animePacks(o).animationsLength();for(n=0;n<c;n++)if(this._fbObj.animePacks(o).animations(n).name()===e){this.curAnimePackName=t,this.curAnimeName=e,this.curAnimePackData=this._fbObj.animePacks(o),this.curAnimation=this.curAnimePackData.animations(n),a=!0;break}if(!a)continue;const r=this.curAnimation.defaultDataLength();for(let h=0;h<r;h++){const d=this.curAnimation.defaultData(h);this.defaultFrameMap[d.index()]=d}this._animePackIdx=o;const l=this.curAnimePackData.partsLength();for(this._parentIndex=new Array(l),n=0;n<l;n++){const h=this.curAnimePackData.parts(n).index();this._parentIndex[h]=this._fbObj.animePacks(o).parts(n).parentIndex()}}if(!a)throw Error("not found animePackName: "+t+" animeName: "+e)}clearCaches(){this._prio2index=[],this.userData=[],this.frameDataCache=null,this.currentCachedFrameNumber=-1,this.defaultFrameMap=[]}HaveUserData(t){if(this.userData[t]===null)return!1;if(this.userData[t]!==void 0)return!0;for(let e=0;e<this.curAnimation.userDataLength();e++)if(t===this.curAnimation.userData(e).frameIndex())return this.userData[t]=this.curAnimation.userData(e),!0;return this.userData[t]=null,!1}GetUserData(t){if(this.HaveUserData(t)===!1)return;const e=this.userData[t],s=e.dataLength();let a=0,o=[];for(let n=0;n<s;n++){const c=e.data(n).flags(),r=e.data(n).arrayIndex();let l=null,h=null,d=null,u=null,f=null,_=null,v=null,S=null,y=null;c&1&&(l=e.data(n).data(a,new qt).integer(),a++),c&2&&(h=e.data(n).data(a,new yt).x(),d=e.data(n).data(a,new yt).y(),u=e.data(n).data(a,new yt).w(),f=e.data(n).data(a,new yt).h(),a++),c&4&&(_=e.data(n).data(a,new Ut).x(),v=e.data(n).data(a,new Ut).y(),a++),c&8&&(S=e.data(n).data(a,new $).length(),y=e.data(n).data(a,new $).data(),a++),o.push([r,c,l,h,d,u,f,_,v,S,y])}return o}I2F(t){return this._uint32[0]=t,this._float32[0]}GetFrameData(t){if(this.currentCachedFrameNumber===t&&this.frameDataCache)return this.frameDataCache;const e=this.curAnimation.defaultDataLength();let s=new Array(e);this._prio2index=new Array(e);const a=this.curAnimation.frameData(t);for(let o=0;o<e;o++){const n=a.states(o),c=n.index();let r=n.flag1(),l=n.flag2(),h=this.GetDefaultDataByIndex(c);h.flag1=r,h.flag2=l;let d=0;if(r&p.INVISIBLE&&(h.f_hide=!0),r&p.FLIP_H&&(h.f_flipH=!0),r&p.FLIP_V&&(h.f_flipV=!0),r&p.CELL_INDEX&&(h.cellIndex=n.data(d++)),r&p.POSITION_X&&(h.positionX=this.I2F(n.data(d++))),r&p.POSITION_Y&&(h.positionY=this.I2F(n.data(d++))),r&p.POSITION_Z&&d++,r&p.PIVOT_X&&(h.pivotX=this.I2F(n.data(d++))),r&p.PIVOT_Y&&(h.pivotY=this.I2F(n.data(d++))),r&p.ROTATIONX&&d++,r&p.ROTATIONY&&d++,r&p.ROTATIONZ&&(h.rotationZ=this.I2F(n.data(d++))),r&p.SCALE_X&&(h.scaleX=this.I2F(n.data(d++))),r&p.SCALE_Y&&(h.scaleY=this.I2F(n.data(d++))),r&p.LOCALSCALE_X&&(h.localscaleX=this.I2F(n.data(d++))),r&p.LOCALSCALE_Y&&(h.localscaleY=this.I2F(n.data(d++))),r&p.OPACITY&&(h.opacity=n.data(d++)),r&p.LOCALOPACITY&&(h.localopacity=n.data(d++)),r&p.SIZE_X&&(h.size_X=this.I2F(n.data(d++))),r&p.SIZE_Y&&(h.size_Y=this.I2F(n.data(d++))),r&p.U_MOVE&&(h.uv_move_X=this.I2F(n.data(d++))),r&p.V_MOVE&&(h.uv_move_Y=this.I2F(n.data(d++))),r&p.UV_ROTATION&&(h.uv_rotation=this.I2F(n.data(d++))),r&p.U_SCALE&&(h.uv_scale_X=this.I2F(n.data(d++))),r&p.V_SCALE&&(h.uv_scale_Y=this.I2F(n.data(d++))),r&p.BOUNDINGRADIUS&&d++,r&p.MASK&&(h.masklimen=n.data(d++)),r&p.PRIORITY&&(h.priority=n.data(d++)),r&p.INSTANCE_KEYFRAME&&(h.instanceValue_curKeyframe=n.data(d++),h.instanceValue_startFrame=n.data(d++),h.instanceValue_endFrame=n.data(d++),h.instanceValue_loopNum=n.data(d++),h.instanceValue_speed=this.I2F(n.data(d++)),h.instanceValue_loopflag=n.data(d++)),r&p.EFFECT_KEYFRAME&&(h.effectValue_curKeyframe=n.data(d++),h.effectValue_startTime=n.data(d++),h.effectValue_speed=this.I2F(n.data(d++)),h.effectValue_loopflag=n.data(d++)),r&p.VERTEX_TRANSFORM){h.f_mesh=!0;const u=h.i_transformVerts=n.data(d++);u&1&&(h.u00=this.I2F(n.data(d++)),h.v00=this.I2F(n.data(d++))),u&2&&(h.u01=this.I2F(n.data(d++)),h.v01=this.I2F(n.data(d++))),u&4&&(h.u10=this.I2F(n.data(d++)),h.v10=this.I2F(n.data(d++))),u&8&&(h.u11=this.I2F(n.data(d++)),h.v11=this.I2F(n.data(d++)))}if(r&p.PARTS_COLOR){const u=n.data(d++);if(h.colorBlendType=u&255,h.useColorMatrix=h.colorBlendType!==1,u&4096){h.colorRate=this.I2F(n.data(d++));const f=n.data(d++),_=n.data(d++);h.colorArgb32=f<<16|_,h.partsColorARGB=h.colorArgb32>>>0,h.colorBlendType===1&&(h.tint=h.colorArgb32&16777215)}}if(l&Yt.MESHDATA){const u=this.curAnimation.meshsDataUv(c);h.meshIsBind=u.uv(0),h.meshNum=u.uv(1);let f=new Float32Array(h.meshNum*3);for(let _=0;_<h.meshNum;_++){const v=this.I2F(n.data(d++)),S=this.I2F(n.data(d++)),y=this.I2F(n.data(d++));f[_*3+0]=v,f[_*3+1]=S,f[_*3+2]=y}h.meshDataPoint=f}s[c]=h,this._prio2index[o]=c,this.curAnimePackData.parts(c).type()===0&&(s[c].cellIndex=-2)}return this.frameDataCache=s,this.currentCachedFrameNumber=t,s}GetDefaultDataByIndex(t){const e=this.defaultFrameMap[t];let s=new Gt;return s.index=e.index(),s.lowflag=e.lowflag(),s.highflag=e.highflag(),s.priority=e.priority(),s.cellIndex=e.cellIndex(),s.opacity=e.opacity(),s.localopacity=e.localopacity(),s.masklimen=e.masklimen(),s.positionX=e.positionX(),s.positionY=e.positionY(),s.pivotX=e.pivotX(),s.pivotY=e.pivotY(),s.rotationX=e.rotationX(),s.rotationY=e.rotationY(),s.rotationZ=e.rotationZ(),s.scaleX=e.scaleX(),s.scaleY=e.scaleY(),s.localscaleX=e.localscaleX(),s.localscaleY=e.localscaleY(),s.size_X=e.sizeX(),s.size_Y=e.sizeY(),s.uv_move_X=e.uvMoveX(),s.uv_move_Y=e.uvMoveY(),s.uv_rotation=e.uvRotation(),s.uv_scale_X=e.uvScaleX(),s.uv_scale_Y=e.uvScaleY(),s.boundingRadius=e.boundingRadius(),s.instanceValue_curKeyframe=e.instanceValueCurKeyframe(),s.instanceValue_endFrame=e.instanceValueEndFrame(),s.instanceValue_startFrame=e.instanceValueStartFrame(),s.instanceValue_loopNum=e.instanceValueLoopNum(),s.instanceValue_speed=e.instanceValueSpeed(),s.instanceValue_loopflag=e.instanceValueLoopflag(),s.effectValue_curKeyframe=e.effectValueCurKeyframe(),s.effectValue_startTime=e.effectValueStartTime(),s.effectValue_speed=e.effectValueSpeed(),s.effectValue_loopflag=e.effectValueLoopflag(),s.f_hide=!1,s.f_flipH=!1,s.f_flipV=!1,s.f_mesh=!1,s.i_transformVerts=0,s.u00=0,s.v00=0,s.u01=0,s.v01=0,s.u10=0,s.v10=0,s.u11=0,s.v11=0,s.useColorMatrix=!1,s.colorBlendType=0,s.colorRate=0,s.colorArgb32=0,s.meshIsBind=0,s.meshNum=0,s.meshDataPoint=null,s.flag1=0,s.flag2=0,s.partsColorARGB=0,s}InheritOpacity(t,e,s){return t=this.GetFrameData(s)[e].opacity/255,this._parentIndex[e]>=0&&(t=this.InheritOpacity(t,this._parentIndex[e],s)),t}TransformVertsLocal(t,e,s){const a=this.GetFrameData(s)[e],o=-a.rotationZ*Math.PI/180,n=Math.cos(o),c=Math.sin(o);for(let r=0;r<t.length/2;r++){let l=t[r*2],h=t[r*2+1];a.i_transformVerts&1&&r===1&&(l+=a.u00,h-=a.v00),a.i_transformVerts&2&&r===2&&(l+=a.u01,h-=a.v01),a.i_transformVerts&4&&r===3&&(l+=a.u10,h-=a.v10),a.i_transformVerts&8&&r===4&&(l+=a.u11,h-=a.v11),l*=a.scaleX*a.localscaleX,h*=a.scaleY*a.localscaleY,t[r*2]=n*l-c*h+a.positionX,t[r*2+1]=c*l+n*h-a.positionY,a.f_flipH&&(t[r*2]=t[0]*2-t[r*2]),a.f_flipV&&(t[r*2+1]=t[1]*2-t[r*2+1])}return this._parentIndex[e]>=0&&(t=this.TransformVerts(t,this._parentIndex[e],s)),t}TransformMeshVertsLocal(t,e,s){const a=this.GetFrameData(s)[e],o=-a.rotationZ*Math.PI/180,n=Math.cos(o),c=Math.sin(o);for(let r=0;r<t.length/2;r++){let l=t[r*2],h=t[r*2+1];l*=a.scaleX*a.localscaleX,h*=a.scaleY*a.localscaleY,t[r*2]=n*l-c*h+a.positionX,t[r*2+1]=c*l+n*h-a.positionY}return this._parentIndex[e]>=0&&(t=this.TransformVerts(t,this._parentIndex[e],s)),t}TransformPositionLocal(t,e,s){const a=this.GetFrameData(s)[e];t[4]+=-a.rotationZ;const o=-a.rotationZ*Math.PI/180,n=Math.cos(o),c=Math.sin(o),r=t[0]*a.scaleX*a.localscaleX,l=t[1]*a.scaleY*a.localscaleY;return t[2]*=a.scaleX*a.localscaleX,t[3]*=a.scaleY*a.localscaleY,t[0]=n*r-c*l+a.positionX,t[1]=c*r+n*l-a.positionY,this._parentIndex[e]>=0&&(t=this.TransformPosition(t,this._parentIndex[e],s)),t}static CoordinateGetDiagonalIntersection(t,e,s,a,o,n,c,r,l,h,d){const u=(r-n)*(c-s)-(c-o)*(r-a),f=(l-s)*(r-a)-(h-a)*(c-s),_=(l-s)*(r-n)-(h-a)*(c-o);if(_<=0&&_>=0)return d;const v=u/_,S=f/_;return 0<=v&&1>=v&&0<=S&&1>=S&&(t=s+v*(l-s),e=a+v*(h-a)),d[0]=t,d[1]=e,d}TransformVerts(t,e,s){const a=this.GetFrameData(s)[e],o=-a.rotationZ*Math.PI/180,n=Math.cos(o),c=Math.sin(o);for(let r=0;r<t.length/2;r++){let l=t[r*2],h=t[r*2+1];l*=a.scaleX,h*=a.scaleY,t[r*2]=n*l-c*h+a.positionX,t[r*2+1]=c*l+n*h-a.positionY,a.f_flipH&&(t[r*2]=t[0]*2-t[r*2]),a.f_flipV&&(t[r*2+1]=t[1]*2-t[r*2+1])}return this._parentIndex[e]>=0&&(t=this.TransformVerts(t,this._parentIndex[e],s)),t}TransformPosition(t,e,s){const a=this.GetFrameData(s)[e];t[4]+=-a.rotationZ;const o=-a.rotationZ*Math.PI/180,n=Math.cos(o),c=Math.sin(o),r=t[0]*a.scaleX,l=t[1]*a.scaleY;return t[2]*=a.scaleX,t[3]*=a.scaleY,t[0]=n*r-c*l+a.positionX,t[1]=c*r+n*l-a.positionY,this._parentIndex[e]>=0&&(t=this.TransformPosition(t,this._parentIndex[e],s)),t}static GetVerts(t,e,s){const a=e.size_X/2,o=e.size_Y/2,n=e.size_X*-(e.pivotX+t.pivotX()),c=e.size_Y*(e.pivotY+t.pivotY());return s.set([n,c,n-a,c-o,n+a,c-o,n-a,c+o,n+a,c+o]),s}static GetMeshVerts(t,e,s){for(let a=0;a<e.meshNum;a++)s[a*2]=e.meshDataPoint[a*3],s[a*2+1]=-e.meshDataPoint[a*3+1];return s}static GetDummyVerts(){return new Float32Array([0,0,-.5,-.5,.5,-.5,-.5,.5,.5,.5])}}class te{constructor(){this.loader=new Jt.Loader}load(t,e,s){for(let o in e)this.loader.add(o,e[o]);const a=this;this.loader.load((o,n)=>{a.resources=n,s!==null&&s(null)})}unload(t,e,s){this.resources=null,s!==null&&s(null)}texture(t){return console.log(this.resources),this.resources[t].texture}}class ee{constructor(){this.loader=new te}load(t,e,s){return this.loader.load(t,e,s)}unload(t,e,s=null){return this.loader.unload(t,e,s)}texture(t){return this.loader.texture(t)}}class Et{constructor(t,e,s,a){if(this.sspjMap={},this.resourceLoader=new ee,typeof t=="string"&&s===void 0){let o=t;this.ssfbPath=o;const n=o.lastIndexOf("/");this.rootPath=o.substring(0,n)+"/",this.ssfbFile=o.substring(n+1),this.onComplete=e===void 0?null:e,this.status=0,this.LoadFlatBuffersProject()}else if(typeof e=="object"&&e.constructor===Uint8Array){this.ssfbPath=null,this.rootPath=null,this.ssfbFile=t;let o=e,n=s;this.onComplete=a===void 0?null:a,this.load(o,n)}}getBundle(){return this.ssfbFile}getTexture(t){return this.resourceLoader.texture(t)}dispose(t=null){this.resourceLoader.unload(this.getBundle(),this.sspjMap,e=>{t!==null&&t()})}LoadFlatBuffersProject(){const t=this;fetch(this.ssfbPath,{method:"get"}).then(e=>e.ok?Promise.resolve(e.arrayBuffer()):Promise.reject(new Error(e.statusText))).then(e=>{t.fbObj=Pt.getProjectData(new Uint8Array(e)),t.LoadCellResources()}).catch(e=>{this.onComplete!==null&&this.onComplete(null,e)})}LoadCellResources(){let t=[];this.sspjMap={};for(let s=0;s<this.fbObj.cellsLength();s++){const a=this.fbObj.cells(s).cellMap(),o=a.index();if(!t.some(function(n){return n===o})){t.push(o);const n=a.name();this.sspjMap[n]=this.rootPath+a.imagePath()}}const e=this;this.resourceLoader.load(this.getBundle(),this.sspjMap,s=>{s===null?(e.status=1,e.onComplete!==null&&e.onComplete(this,null)):this.onComplete!==null&&this.onComplete(null,s)})}load(t,e){this.fbObj=Pt.getProjectData(t);let s={};for(let o in e){const n=e[o];let c="";const r=n.byteLength;for(let l=0;l<r;l++)c+=String.fromCharCode(n[l]);s[o]="data:image/png;base64,"+btoa(c)}const a=this;this.resourceLoader.load(this.getBundle(),s,o=>{o===null?(a.status=1,a.onComplete!==null&&a.onComplete(this,null)):this.onComplete!==null&&this.onComplete(null,o)})}}class se{constructor(){this.refStartframe=0,this.refEndframe=0,this.refSpeed=1,this.refloopNum=0,this.infinity=!1,this.reverse=!1,this.pingpong=!1,this.independent=!1}}class J extends Nt.Container{constructor(t,e=null,s=null){super(),this.liveFrame=[],this.colorMatrixFilterCache=[],this.parentAlpha=1,this.prevCellID=[],this.prevPartObject=[],this.substituteOverWrite=[],this.substituteKeyParam=[],this.alphaBlendType=[],this.defaultColorFilter=new wt.ColorMatrixFilter,this._instancePos=new Float32Array(5),this._CoordinateGetDiagonalIntersectionVec2=new Float32Array(2),this.ss6project=t,this.playerLib=new lt(t.fbObj,e,s),this.parentAlpha=1,e!==null&&s!==null&&this.Setup(e,s),this.on("added",(...a)=>{gt.Ticker.shared.add(this.Update,this)},this),this.on("removed",(...a)=>{gt.Ticker.shared.remove(this.Update,this)},this)}get startFrame(){return this._startFrame}get endFrame(){return this._endFrame}get totalFrame(){return this.playerLib.animationData.totalFrames()}get fps(){return this.playerLib.animationData.fps()}get frameNo(){return Math.floor(this._currentFrame)}set loop(t){this._loops=t}get loop(){return this._loops}get isPlaying(){return this._isPlaying}get isPausing(){return this._isPausing}get animePackName(){return this.playerLib.animePackName}get animeName(){return this.playerLib.animeName}Setup(t,e){this.playerLib.Setup(t,e),this.clearCaches();const s=this.playerLib.animePackData,a=s.partsLength();this.prevCellID=new Array(a),this.prevPartObject=new Array(a),this.substituteOverWrite=new Array(a),this.substituteKeyParam=new Array(a);for(let o=0;o<a;o++){const n=s.parts(o).index();this.prevCellID[n]=-1,this.prevPartObject[n]=null,this.substituteOverWrite[n]=null,this.substituteKeyParam[n]=null}this.alphaBlendType=this.GetPartsBlendMode(),this._isPlaying=!1,this._isPausing=!0,this._startFrame=this.playerLib.animationData.startFrames(),this._endFrame=this.playerLib.animationData.endFrames(),this._currentFrame=this.playerLib.animationData.startFrames(),this.nextFrameTime=0,this._loops=-1,this.skipEnabled=!0,this.updateInterval=1e3/this.playerLib.animationData.fps(),this.playDirection=1,this.onUserDataCallback=null,this.playEndCallback=null,this.parentAlpha=1}clearCaches(){this.liveFrame=[],this.colorMatrixFilterCache=[]}Update(t){this.UpdateInternal(t)}UpdateInternal(t,e=!0){const s=gt.Ticker.shared.elapsedMS;if(this._isPlaying&&!this._isPausing&&this.updateInterval!==0){if(this.nextFrameTime+=s,this.nextFrameTime>=this.updateInterval){let o=!1;const n=this.nextFrameTime/this.updateInterval;this.nextFrameTime-=this.updateInterval*n;let c=this.skipEnabled?n*this.playDirection:this.playDirection,r=this._currentFrame+c,l=Math.floor(r),h=r-l,d=Math.floor(this._currentFrame);if(this.playDirection>=1)for(let u=l-d;u;u--){let f=d+1;if(f>this._endFrame)if(this._loops===-1)f=this._startFrame;else if(this._loops--,o=!0,this._loops===0){this._isPlaying=!1,f=e?this._startFrame:this._endFrame;break}else f=this._startFrame;d=f,this._isPlaying&&this.playerLib.HaveUserData(d)&&this.onUserDataCallback!==null&&this.onUserDataCallback(this.playerLib.GetUserData(d))}if(this.playDirection<=-1)for(let u=d-l;u;u--){let f=d-1;if(f<this._startFrame)if(this._loops===-1)f=this._endFrame;else if(this._loops--,o=!0,this._loops===0){this._isPlaying=!1,f=e?this._endFrame:this._startFrame;break}else f=this._endFrame;d=f,this._isPlaying&&this.playerLib.HaveUserData(d)&&this.onUserDataCallback!==null&&this.onUserDataCallback(this.playerLib.GetUserData(d))}this._currentFrame=d+h,o&&this.playEndCallback!==null&&this.playEndCallback(this),this.SetFrameAnimation(Math.floor(this._currentFrame),n)}}else this.SetFrameAnimation(Math.floor(this._currentFrame))}SetAnimationFramerate(t,e=!0){t<=0||(this.updateInterval=1e3/t,this.skipEnabled=e)}SetAnimationSpeed(t,e=!0){t!==0&&(this.playDirection=t>0?1:-1,this.updateInterval=1e3/(this.playerLib.animationData.fps()*t*this.playDirection),this.skipEnabled=e)}SetAnimationSection(t=-1,e=-1,s=-1){t>=0&&t<this.playerLib.animationData.totalFrames()&&(this._startFrame=t),e>=0&&e<this.playerLib.animationData.totalFrames()&&(this._endFrame=e),s>0?this._loops=s:this._loops=-1,this._currentFrame=this.playDirection>0?this._startFrame:this._endFrame}Play(t){this._isPlaying=!0,this._isPausing=!1;let e=this.playDirection>0?this._startFrame:this._endFrame;t&&typeof t=="number"&&(e=t),this._currentFrame=e,this.resetLiveFrame();const s=Math.floor(this._currentFrame);this.SetFrameAnimation(s),this.playerLib.HaveUserData(s)&&this.onUserDataCallback!==null&&this.onUserDataCallback(this.playerLib.GetUserData(s))}Pause(){this._isPausing=!0}Resume(){this._isPausing=!1}Stop(){this._isPlaying=!1}SetFrame(t){this._currentFrame=t}NextFrame(){const t=Math.floor(this._currentFrame),e=this.endFrame;t!==e&&this.SetFrame(t+1)}PrevFrame(){const t=Math.floor(this._currentFrame);t!==0&&this.SetFrame(t-1)}SetAlpha(t){this.parentAlpha=t}ThrowError(t){}SetUserDataCalback(t){this.onUserDataCallback=t}SetPlayEndCallback(t){this.playEndCallback=t}GetPartsBlendMode(){const t=this.playerLib.animePackData,e=t.partsLength();let s=[];for(let a=0;a<e;a++){const o=t.parts(a).alphaBlendType();let n;switch(o){case 0:n=k.BLEND_MODES.NORMAL;break;case 1:n=k.BLEND_MODES.MULTIPLY;break;case 2:n=k.BLEND_MODES.ADD;break;case 3:n=k.BLEND_MODES.NORMAL;break;case 4:n=k.BLEND_MODES.MULTIPLY;break;case 5:n=k.BLEND_MODES.SCREEN;break;case 6:n=k.BLEND_MODES.EXCLUSION;break;case 7:n=k.BLEND_MODES.NORMAL;break;default:n=k.BLEND_MODES.NORMAL;break}s.push(n)}return s}GetColorMatrixFilter(t,e,s){const a=t.toString()+"_"+e.toString()+"_"+s.toString();if(this.colorMatrixFilterCache[a])return this.colorMatrixFilterCache[a];const o=new wt.ColorMatrixFilter,n=((s&4278190080)>>>24)/255,c=((s&16711680)>>>16)/255,r=((s&65280)>>>8)/255,l=(s&255)/255;if(t===0){const h=1-e;o.matrix=[h,0,0,0,c*e,0,h,0,0,r*e,0,0,h,0,l*e,0,0,0,1,0]}else t===1?o.matrix=[c,0,0,0,0,0,r,0,0,0,0,0,l,0,0,0,0,0,n,0]:t===2?o.matrix=[1,0,0,0,c,0,1,0,0,r,0,0,1,0,l,0,0,0,n,0]:t===3&&(o.matrix=[1,0,0,0,-c,0,1,0,0,-r,0,0,1,0,-l,0,0,0,n,0]);return this.colorMatrixFilterCache[a]=o,o}SetFrameAnimation(t,e=0){const s=this.playerLib.GetFrameData(t);this.removeChildren();const a=s.length;for(let o=0;o<a;o=o+1|0){const n=this.playerLib.prio2index[o],c=s[n],r=c.cellIndex;let l=this.prevPartObject[n];const h=this.playerLib.animePackData.parts(n),d=h.type();let u=this.substituteOverWrite[n]!==null?this.substituteOverWrite[n]:!1,f=this.substituteKeyParam[n];switch(d){case E.Instance:l==null&&(l=this.MakeCellPlayer(h.refname()),l.name=h.name());break;case E.Normal:case E.Mask:r>=0&&this.prevCellID[n]!==r&&(l?.destroy(),l=this.MakeCellMesh(r),l.name=h.name());break;case E.Mesh:r>=0&&this.prevCellID[n]!==r&&(l?.destroy(),l=this.MakeMeshCellMesh(n,r),l.name=h.name());break;case E.Nulltype:case E.Joint:this.prevCellID[n]!==r&&(l?.destroy(),l=new Nt.Container,l.name=h.name());break;default:r>=0&&this.prevCellID[n]!==r&&(l?.destroy(),l=this.MakeCellMesh(r),l.name=h.name());break}if(l!=null)switch(this.prevCellID[n]=r,this.prevPartObject[n]=l,d){case E.Instance:{const _=l;this._instancePos[0]=0,this._instancePos[1]=0,this._instancePos[2]=1,this._instancePos[3]=1,this._instancePos[4]=0,this._instancePos=this.playerLib.TransformPositionLocal(this._instancePos,c.index,t),_.rotation=this._instancePos[4]*Math.PI/180,_.position.set(this._instancePos[0],this._instancePos[1]),_.scale.set(this._instancePos[2],this._instancePos[3]);let v=c.opacity/255;c.localopacity<255&&(v=c.localopacity/255),_.SetAlpha(v*this.parentAlpha),_.visible=!c.f_hide;let S=c.instanceValue_curKeyframe,y=c.instanceValue_startFrame,m=c.instanceValue_endFrame,Z=c.instanceValue_speed,G=c.instanceValue_loopNum,nt=!1,Y=!1,P=!1,T=!1;const q=1,Q=2,L=4,N=8,w=c.instanceValue_loopflag;w&q&&(nt=!0),w&Q&&(Y=!0),w&L&&(P=!0),w&N&&(T=!0),u&&(y=f.refStartframe,m=f.refEndframe,Z=f.refSpeed,G=f.refloopNum,nt=f.infinity,Y=f.reverse,P=f.pingpong,T=f.independent),(_._startFrame!==y||_._endFrame!==m)&&_.SetAnimationSection(y,m);let U=t;T===!0&&(this.liveFrame[o]+=e,U=Math.floor(this.liveFrame[o]));const tt=S;let I=Math.floor((U-tt)*Z);if(I<0||tt>U)continue;const j=m-y+1;if(j<=0)continue;let A=Math.floor(I/j),z=G;P&&(z=z*2),nt||A>=z&&(I=j-1,A=z-1);const et=Math.floor(I%j);let K=0;P&&A%2===1&&(Y?Y=!1:Y=!0),this.playDirection<=-1&&(Y=!Y),Y?K=m-et:K=et+y,_.SetFrame(Math.floor(K)),this.addChild(_);break}case E.Normal:case E.Mesh:case E.Joint:case E.Mask:{const _=l,v=_.geometry.getBuffer("aVertexPosition");let S=v.data;const y=this.playerLib.fbObj.cells(r);let m;if(d===E.Mesh?c.meshIsBind===0?m=this.playerLib.TransformMeshVertsLocal(lt.GetMeshVerts(y,c,S),c.index,t):m=lt.GetMeshVerts(y,c,S):(m=d===E.Joint?new Float32Array(10):S,m=this.playerLib.TransformVertsLocal(lt.GetVerts(y,c,m),c.index,t)),c.flag1&p.VERTEX_TRANSFORM){const P=m[6],T=m[3*2+1],q=m[1*2+0],Q=m[1*2+1],L=m[4*2+0],N=m[4*2+1],w=m[2*2+0],U=m[2*2+1],tt=(P+L)*.5,I=(T+N)*.5,j=(P+q)*.5,A=(T+Q)*.5,z=(q+w)*.5,et=(Q+U)*.5,K=(L+w)*.5,dt=(N+U)*.5,ft=lt.CoordinateGetDiagonalIntersection(m[0],m[1],tt,I,K,dt,j,A,z,et,this._CoordinateGetDiagonalIntersectionVec2);m[0]=ft[0],m[1]=ft[1]}const Z=m[0],G=m[1];for(let P=0;P<m.length/2;P++)m[P*2]-=Z,m[P*2+1]-=G;if(S=m,v.update(),c.flag1&p.U_MOVE||c.flag1&p.V_MOVE||c.flag1&p.U_SCALE||c.flag1&p.V_SCALE||c.flag1&p.UV_ROTATION){const P=y.u1()+c.uv_move_X,T=y.u2()+c.uv_move_X,q=y.v1()+c.uv_move_Y,Q=y.v2()+c.uv_move_Y,L=(T+P)/2,N=(Q+q)/2,w=(T-P)/2*c.uv_scale_X,U=(Q-q)/2*c.uv_scale_Y,tt=_.uvBuffer;let I=tt.data;if(I[0]=L,I[1]=N,I[2]=L-w,I[3]=N-U,I[4]=L+w,I[5]=N-U,I[6]=L-w,I[7]=N+U,I[8]=L+w,I[9]=N+U,c.flag1&p.UV_ROTATION){const j=c.uv_rotation*Math.PI/180;for(let A=0;A<5;A++){const z=I[A*2+0]-L,et=I[A*2+1]-N,K=Math.cos(j),dt=Math.sin(j),ft=K*z-dt*et,Oe=dt*z+K*et;I[A*2+0]=L+ft,I[A*2+1]=N+Oe}}tt.update()}_.position.set(Z,G);let nt=c.opacity/255;if(c.localopacity<255&&(nt=c.localopacity/255),_.alpha=nt*this.parentAlpha,_.visible=!c.f_hide,c.useColorMatrix){const P=this.GetColorMatrixFilter(c.colorBlendType,c.colorRate,c.colorArgb32);_.filters=[P]}if(c.tint){_.tint=c.tint;const P=((c.partsColorARGB&4278190080)>>>24)/255;_.alpha=_.alpha*P}const Y=this.alphaBlendType[n];(Y===k.BLEND_MODES.MULTIPLY||Y===k.BLEND_MODES.SCREEN)&&(_.alpha=1),d!==E.Mask&&this.addChild(_);break}case E.Nulltype:{const _=l,v=this.playerLib.InheritOpacity(1,c.index,t);_.alpha=v*c.localopacity/255;const S=this.playerLib.TransformVerts(lt.GetDummyVerts(),c.index,t),y=S[0],m=S[1];_.position.set(y,m);const Z=Math.atan2(S[5]-S[3],S[4]-S[2]),G=Math.atan2(S[7]-S[3],S[6]-S[2]);_.rotation=Z,_.skew.x=G-Z-Math.PI/2;break}}}}ChangeInstanceAnime(t,e,s,a,o=null){let n=!1;if(this.animePackName!==null&&this.animeName!==null){let c=this.playerLib.animePackData,r=c.partsLength();for(let l=0;l<r;l++){let h=c.parts(l);if(h.name()===t){let d=this.prevPartObject[l];if(d===null||d instanceof J){this.substituteOverWrite[l]=a;let u;o!==null?(u=o,d=this.MakeCellPlayer(e+"/"+s,o.refStartframe)):(d=this.MakeCellPlayer(e+"/"+s),u=new se,u.refStartframe=d.startFrame,u.refEndframe=d.endFrame),d.name=h.name(),this.prevPartObject[l]=d,this.substituteKeyParam[l]=u,n=!0;break}}}}return n}MakeCellMesh(t){const e=this.playerLib.fbObj.cells(t),s=e.u1(),a=e.u2(),o=e.v1(),n=e.v2(),c=e.width()/2,r=e.height()/2,l=new Float32Array([0,0,-c,-r,c,-r,-c,r,c,r]),h=new Float32Array([(s+a)/2,(o+n)/2,s,o,a,o,s,n,a,n]),d=new Uint16Array([0,1,2,0,2,4,0,4,3,0,1,3]),u=new ht.MeshGeometry(l,h,d),f=new ht.MeshMaterial(this.ss6project.getTexture(e.cellMap().name()));return new ht.Mesh(u,f,null,k.DRAW_MODES.TRIANGLES)}MakeMeshCellMesh(t,e){const s=this.playerLib.animationData.meshsDataUv(t),a=s.uvLength();if(a>0){const o=new Float32Array(a-2),n=s.uv(1);for(let f=2;f<a;f++)o[f-2]=s.uv(f);const c=this.playerLib.animationData.meshsDataIndices(t),r=c.indicesLength(),l=new Uint16Array(r-1);for(let f=1;f<r;f++)l[f-1]=c.indices(f);const h=new Float32Array(n*2),d=new ht.MeshGeometry(h,o,l),u=new ht.MeshMaterial(this.ss6project.getTexture(this.playerLib.fbObj.cells(e).cellMap().name()));return new ht.Mesh(d,u,null,k.DRAW_MODES.TRIANGLES)}return null}MakeCellPlayer(t,e=void 0){const s=t.split("/"),a=new J(this.ss6project);return a.Setup(s[0],s[1]),a.Play(e),a}resetLiveFrame(){const t=this.playerLib.animationData.defaultDataLength();for(let e=0;e<t;e++)this.liveFrame[e]=0}}var ie=Object.defineProperty,ae=(i,t,e)=>t in i?ie(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,X=(i,t,e)=>(ae(i,typeof t!="symbol"?t+"":t,e),e);const Bt=class _t{constructor(){X(this,"pluginParameters"),X(this,"animationDir"),X(this,"replaceSVActorSpriteFlag"),X(this,"svActorDir"),X(this,"svActorAnimationPack"),X(this,"svActorHideWeaponGraphics"),X(this,"replaceSVEnemySpriteFlag"),X(this,"svEnemyDir"),X(this,"svEnemyAnimationPack"),X(this,"svEnemyAnimationName"),this.pluginParameters=PluginManager.parameters("ss6player-rpgmakermz"),this.animationDir=String(this.pluginParameters.animationDir||"img/ssfb")+"/",this.replaceSVActorSpriteFlag=this.pluginParameters.replaceSVActorSpriteFlag==="true"||!1,this.svActorDir=String(this.pluginParameters.svActorDir||"img/ssfb/sv_actors")+"/",this.svActorAnimationPack=String(this.pluginParameters.svActorAnimationPack||"motions"),this.svActorHideWeaponGraphics=this.pluginParameters.svActorHideWeaponGraphics==="true"||!1,this.replaceSVEnemySpriteFlag=this.pluginParameters.replaceSVEnemySpriteFlag==="true"||!1,this.svEnemyDir=String(this.pluginParameters.svEnemyDir||"img/ssfb/sv_enemies")+"/",this.svEnemyAnimationPack=String(this.pluginParameters.svEnemyAnimationPack||"motions"),this.svEnemyAnimationName=String(this.pluginParameters.svEnemyAnimationName||"walk")}static getInstance(){return _t.instance||(_t.instance=new _t),_t.instance}};X(Bt,"instance");let V=Bt;var ne=Object.defineProperty,oe=(i,t,e)=>t in i?ne(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ot=(i,t,e)=>(oe(i,typeof t!="symbol"?t+"":t,e),e);const Xt=class bt{constructor(){Ot(this,"ssprojectMap"),Ot(this,"_isLoading"),this.clear(),this._isLoading=!1}prepare(t){this.ssprojectMap.set(t,null),this._isLoading=!0}isLoading(){return this._isLoading}isExist(t){return this.ssprojectMap.has(t)&&this.ssprojectMap.get(t)!==null}set(t,e){this.ssprojectMap.set(t,e),this._isLoading=!1}get(t){return this.ssprojectMap.has(t)?this.ssprojectMap.get(t):null}clear(){this.ssprojectMap=new Map}static getInstance(){return bt.instance||(bt.instance=new bt),bt.instance}};Ot(Xt,"instance");let F=Xt;const Vt="ss6player-rpgmakermz",Tt="ss6projectLoadWait",jt="ss6playerPlayWaitMode";let Mt=!1,It=null,Ct=null,zt=null;PluginManager.registerCommand(Vt,"loadSsfb",function(i){const t=Number(i.ssfbId),e=i.ssfbFile,s=V.getInstance().animationDir+e;if(F.getInstance().isExist(t)){const o=F.getInstance().get(t);if(s===o.ssfbPath)return}this.setWaitMode(Tt),F.getInstance().prepare(t);let a=new Et(s,()=>{F.getInstance().set(t,a)},180*1e3,3,(o,n,c,r)=>{throw this.setWaitMode(""),r},(o,n,c,r)=>{throw console.log("timeout download ssfb file: "+o),this.setWaitMode(""),r},null)}),PluginManager.registerCommand(Vt,"setAsPicture",function(i){const t=Number(i.ssfbId),e=i.animePackName,s=i.animeName,a=Number(i.scaleX)||1,o=Number(i.scaleY)||1,n=Number(i.loop)||1;let c=F.getInstance().get(t);if(c===null){const l="not found ssfbId: "+t;throw console.error(l),l}let r=new J(c,e,s);r.scale=new PIXI.Point(a,o),r.loop=n,It=r}),PluginManager.registerCommand(Vt,"waitForPicture",function(i){const t=Number(i.pictureId)||1,e=$gameScreen.picture(t);e&&e.mzkpSS6Player?e.mzkpSS6Player instanceof J&&(e.mzkpSS6Player.loop!==-1?(this.setWaitMode(jt),Mt=!0,Ct=function(a){a.loop===0&&(Mt=!1)}):console.warn("pictureId: "+t+" can not wait SS6Player because setting infinity loop.")):console.warn("pictureId: "+t+" not have SS6Player")});const re=Game_Interpreter.prototype.updateWaitMode;Game_Interpreter.prototype.updateWaitMode=function(){let i=!1;return this._waitMode===Tt?i=F.getInstance().isLoading():this._waitMode===jt?i=Mt:i=re.call(this),i};const ce=Game_Picture.prototype.show;Game_Picture.prototype.show=function(){ce.apply(this,arguments),this._name===""&&It!==null&&(this.mzkpSS6Player=It,this.mzkpSS6PlayerChanged=!0,It=null)};const he=Sprite_Picture.prototype.destroy;Sprite_Picture.prototype.destroy=function(i){this.mzkpSS6Player!==null&&this.mzkpSS6Player instanceof J&&(this.mzkpSS6Player.Stop(),this.picture().mzkpSS6PlayerPrevFrameNo=this.mzkpSS6Player.frameNo,this.removeChild(this.mzkpSS6Player),this.mzkpSS6Player=null),he.call(this,i)};const le=Game_Screen.prototype.erasePicture;Game_Screen.prototype.erasePicture=function(i){const t=this._pictures[i];t&&t.mzkpSS6Player&&(t.mzkpSS6Player=null),le.call(this,i)};const de=Scene_Base.prototype.terminate;Scene_Base.prototype.terminate=function(){$gameActors._data.forEach((i,t,e)=>{i&&i._svActorSS6Player&&(i._svActorSS6Player.Stop(),i._svActorSS6PlayerParent.removeChild(i._svActorSS6Player),i._svActorSS6Player=null,i._svActorSS6PlayerParent=null)}),$gameTroop.members().forEach((i,t,e)=>{i&&i._svEnemySS6Player&&(i._svEnemySS6Player.Stop(),i._svEnemySS6PlayerParent.removeChild(i._svEnemySS6Player),i._svEnemySS6ProjectLoaded=!1,i._svEnemySS6Player=null,i._svEnemySS6PlayerParent=null)}),de.apply(this,arguments)};const fe=Sprite_Picture.prototype.updateBitmap;Sprite_Picture.prototype.updateBitmap=function(){if(fe.apply(this,arguments),this.visible&&this._pictureName===""){const i=this.picture(),t=i&&i.mzkpSS6Player||null,e=i&&i.mzkpSS6PlayerChanged;if(this.mzkpSS6Player!==t||e)if(t!==null){if(t.loop===0){this.mzkpSS6Player&&(this.mzkpSS6Player.Stop(),this.removeChild(this.mzkpSS6Player),this.mzkpSS6Player=null,i.mzkpSS6Player=null);return}const s=Ct,a=zt,o=this;t.SetPlayEndCallback(()=>{s!==null&&s(t),t.loop===0&&(t.Stop(),o.removeChild(t)),a!==null&&a(t)}),this.mzkpSS6Player&&(this.mzkpSS6Player.Stop(),this.removeChild(this.mzkpSS6Player)),this.mzkpSS6Player=t,this.addChild(this.mzkpSS6Player),this.mzkpSS6Player.Play(i.mzkpSS6PlayerPrevFrameNo),i.mzkpSS6PlayerChanged=!1,Ct=null,zt=null}else this.mzkpSS6Player=null}else this.mzkpSS6Player!==null&&this.mzkpSS6Player instanceof J&&(this.mzkpSS6Player.Stop(),this.removeChild(this.mzkpSS6Player)),this.mzkpSS6Player=null};const _e=Game_Screen.prototype.clear;Game_Screen.prototype.clear=function(){F.getInstance().clear(),_e.call(this)};let Dt=!1;const be=SceneManager.updateScene;SceneManager.updateScene=function(){be.apply(this,arguments),this._scene&&(this.isGameActive()?Dt&&($gameScreen._pictures.forEach((i,t,e)=>{i&&i.mzkpSS6Player&&i.mzkpSS6Player.Resume()}),$gameActors._data.forEach((i,t,e)=>{i&&i._svActorSS6Player&&i._svActorSS6Player.Resume()}),$gameTroop.members().forEach((i,t,e)=>{i&&i._svEnemySS6Player&&i._svEnemySS6Player.Resume()}),Dt=!1):($gameScreen&&$gameScreen._pictures&&$gameScreen._pictures.forEach((i,t,e)=>{i&&i.mzkpSS6Player&&i.mzkpSS6Player.Pause()}),$gameActors&&$gameActors._data&&$gameActors._data.forEach((i,t,e)=>{i&&i._svActorSS6Player&&i._svActorSS6Player.Pause()}),$gameTroop&&$gameTroop.members()&&$gameTroop.members().forEach((i,t,e)=>{i&&i._svEnemySS6Player&&i._svEnemySS6Player.Pause()}),Dt=!0))};let Rt=!1;const Wt=DataManager.isDatabaseLoaded;DataManager.isDatabaseLoaded=function(){return V.getInstance().replaceSVEnemySpriteFlag?Wt.call(this)?(Rt||(this.loadEnemyNoteTags(),Rt=!0),!0):!1:Wt.call(this)};const pe="SS6SVEnemy",ue="file",me="animationPackName",Se="animationName",ye="scaleX",Ie="scaleY",ge="offsetX",Fe="offsetY";DataManager.loadEnemyNoteTags=function(){const i=new RegExp("<"+pe+" (.*):(.*)>","i");$dataEnemies.forEach((t,e,s)=>{if(t===null)return;t.note.split(/\r?\n/).forEach((o,n,c)=>{const r=i.exec(o);if(r&&r.length===3){const l=r[1].toLowerCase(),h=r[2];switch(l){case ue.toLowerCase():t._svEnemyFile=h;break;case me.toLowerCase():t._svEnemyAnimationPackName=h;break;case Se.toLowerCase():t._svEnemyAnimationName=h;break;case ye.toLowerCase():t._svEnemyScaleX=Number(h);break;case Ie.toLowerCase():t._svEnemyScaleY=Number(h);break;case ge.toLowerCase():t._svEnemyOffsetX=Number(h);break;case Fe.toLowerCase():t._svEnemyOffsetY=Number(h);break}}})})},Sprite_Actor.svActorSsfbId=function(i){return"sv_actor_"+i},Sprite_Actor.svActorSsfbDir=function(i){return V.getInstance().svActorDir+String(i)+"/"},Sprite_Actor.svActorSsfbPath=function(i){return Sprite_Actor.svActorSsfbDir(i)+String(i)+".ssfb"};let Zt=new Map;const ve=Sprite_Actor.prototype.setBattler;Sprite_Actor.prototype.setBattler=function(i){const t=i!==this._actor;if(ve.call(this,i),V.getInstance().replaceSVActorSpriteFlag&&t){let e,s,a;if(Imported.VisuMZ_0_CoreEngine&&Imported.VisuMZ_1_BattleCore&&this instanceof Sprite_SvEnemy?(e=this._actor.enemyId(),s="sv_enemy_"+e,a=V.getInstance().svActorDir+"svenemy"+String(e)+"/"+String(e)+".ssfb"):(e=this._actor.actorId(),s=Sprite_Actor.svActorSsfbId(e),a=Sprite_Actor.svActorSsfbPath(e)),Zt.has(s))return;if(F.getInstance().isExist(s)){const n=F.getInstance().get(s);if(a===n.ssfbPath){this._actor._svActorSS6Player=null,this._actor._svActorSS6PlayerParent=null;return}}F.getInstance().prepare(s);let o=new Et(a,()=>{this._actor._svActorSS6Player=null,this._actor._svActorSS6PlayerParent=null,F.getInstance().set(s,o)},180*1e3,3,(n,c,r,l)=>{Zt.set(s,null),F.getInstance().set(s,null)})}};const Kt=Sprite_Actor.prototype.updateBitmap;Sprite_Actor.prototype.updateBitmap=function(){if(V.getInstance().replaceSVActorSpriteFlag){const i=this._actor.actorId(),t=Sprite_Actor.svActorSsfbId(i);F.getInstance().isExist(t)&&this._actor._svActorSS6Player!==void 0?(Sprite_Battler.prototype.updateBitmap.call(this),this._mainSprite.bitmap=null,this.updateSS6Player()):Kt.call(this)}else Kt.call(this)},Sprite_Actor.prototype.updateSS6Player=function(){let i="";for(let t in Sprite_Actor.MOTIONS){const e=Sprite_Actor.MOTIONS[t];this._motion===e&&(i=t)}if(i===""&&(i="walk"),this._actor._svActorSS6Player===null||this._actor._svActorSS6Player.animeName!==i){this._actor._svActorSS6Player&&(this._mainSprite.removeChild(this._actor._svActorSS6Player),this._actor._svActorSS6Playe=null,this._actor._svActorSS6PlayerParent=null);const t=this._motion.loop,e=this._actor.actorId(),s=Sprite_Actor.svActorSsfbId(e),a=F.getInstance().get(s),o=V.getInstance().svActorAnimationPack;this._actor._svActorSS6Player=new J(a,o,i),this._actor._svActorSS6Player.loop=t?-1:1,this._actor._svActorSS6Player.SetPlayEndCallback(n=>{n.loop===0&&this.refreshMotion()}),this._actor._svActorSS6Player.Play(),this._mainSprite.addChild(this._actor._svActorSS6Player),this._actor._svActorSS6PlayerParent=this._mainSprite}};const xt=Sprite_Actor.prototype.setupWeaponAnimation;Sprite_Actor.prototype.setupWeaponAnimation=function(){V.getInstance().replaceSVActorSpriteFlag?V.getInstance().svActorHideWeaponGraphics?this._actor._svActorSS6Player===void 0&&xt.call(this):xt.call(this):xt.call(this)},Sprite_Enemy.svEnemySsfbId=function(i){return"sv_enemy_"+i},Sprite_Enemy.svEnemySsfbDir=function(i){return V.getInstance().svEnemyDir+String(i)+"/"},Sprite_Enemy.svEnemySsfbPath=function(i){return Sprite_Enemy.svEnemySsfbDir(i)+String(i)+".ssfb"};let Ht=new Map;const Pe=Sprite_Enemy.prototype.setBattler;Sprite_Enemy.prototype.setBattler=function(i){const t=i!==this._enemy;if(Pe.call(this,i),V.getInstance().replaceSVEnemySpriteFlag&&t){const e=this._enemy.enemyId(),s=Sprite_Enemy.svEnemySsfbId(e);if(Ht.has(s))return;let a=Sprite_Enemy.svEnemySsfbPath(e);const o=this._enemy.enemy();if(o._svEnemyFile&&(a=V.getInstance().animationDir+o._svEnemyFile),this._enemy._svEnemySS6ProjectLoaded=!1,F.getInstance().isExist(s)){const c=F.getInstance().get(s);if(a===c.ssfbPath){this._enemy._svEnemySS6ProjectLoaded=!0,this._enemy._svEnemySS6Player=null,this._enemy._svEnemySS6PlayerParent=null;return}}F.getInstance().prepare(s);let n=new Et(a,()=>{this._enemy._svEnemySS6ProjectLoaded=!0,this._enemy._svEnemySS6Player=null,this._enemy._svEnemySS6PlayerParent=null,F.getInstance().set(s,n)},180*1e3,3,(c,r,l,h)=>{this._enemy._svEnemySS6ProjectLoaded=!0,Ht.set(s,null),F.getInstance().set(s,null)})}};const $t=Sprite_Enemy.prototype.updateBitmap;Sprite_Enemy.prototype.updateBitmap=function(){if(V.getInstance().replaceSVEnemySpriteFlag){const i=this._enemy.enemyId(),t=Sprite_Enemy.svEnemySsfbId(i);if(!this._enemy._svEnemySS6ProjectLoaded)return;F.getInstance().isExist(t)&&this._enemy._svEnemySS6Player!==void 0?(Sprite_Battler.prototype.updateBitmap.call(this),this.bitmap=null,this.updateSS6Player()):$t.call(this)}else $t.call(this)},Sprite_Enemy.prototype.updateSS6Player=function(){if(this._enemy._svEnemySS6Player===null){const i=this._enemy.enemyId(),t=Sprite_Enemy.svEnemySsfbId(i),e=F.getInstance().get(t);let s=V.getInstance().svEnemyAnimationPack,a=V.getInstance().svEnemyAnimationName,o=1,n=1,c=0,r=0;const l=this._enemy.enemy();l._svEnemyAnimationPackName&&(s=l._svEnemyAnimationPackName),l._svEnemyAnimationName&&(a=l._svEnemyAnimationName),l._svEnemyScaleX&&(o=l._svEnemyScaleX),l._svEnemyScaleY&&(n=l._svEnemyScaleY),l._svEnemyOffsetX&&(c=l._svEnemyOffsetX),l._svEnemyOffsetY&&(r=l._svEnemyOffsetY),this._enemy._svEnemySS6Player=new J(e,s,a),this._enemy._svEnemySS6Player.loop=-1,this._enemy._svEnemySS6Player.SetPlayEndCallback(h=>{}),this._enemy._svEnemySS6Player.scale.x=o,this._enemy._svEnemySS6Player.scale.y=n,this._enemy._svEnemySS6Player.position.x+=c,this._enemy._svEnemySS6Player.position.y+=r,this._enemy._svEnemySS6Player.Play(),this.addChild(this._enemy._svEnemySS6Player),this._enemy._svEnemySS6PlayerParent=this}};const Lt=Sprite_Enemy.prototype.updateFrame;Sprite_Enemy.prototype.updateFrame=function(){if(V.getInstance().replaceSVEnemySpriteFlag){const i=this._enemy.enemyId(),t=Sprite_Enemy.svEnemySsfbId(i);if(!this._enemy._svEnemySS6ProjectLoaded)return;if(F.getInstance().isExist(t)&&this._enemy._svEnemySS6Player!==void 0){if(this.bitmap){Lt.call(this);return}Sprite_Battler.prototype.updateFrame.call(this);const s=this._enemy._svEnemySS6Player;let a=0,o=0;s&&(a=s.width,o=s.height),this._effectType==="bossCollapse"?this.setFrame(0,0,a,this._effectDuration):this.setFrame(0,0,a,o)}else Lt.call(this)}else Lt.call(this)};const Ee=Sprite_Enemy.prototype.updateStateSprite;Sprite_Enemy.prototype.updateStateSprite=function(){if(V.getInstance().replaceSVEnemySpriteFlag)if(this.bitmap)this._stateIconSprite.y=-Math.round((this.bitmap.height+40)*.9),this._stateIconSprite.y<20-this.y&&(this._stateIconSprite.y=20-this.y);else{let i=0;this._enemy&&this._enemy._svEnemySS6Player&&(i=this._enemy._svEnemySS6Player),this._stateIconSprite.y=-Math.round((i+40)*.9),this._stateIconSprite.y<20-this.y&&(this._stateIconSprite.y=20-this.y)}else Ee.call(this)}}(PIXI,PIXI,PIXI,PIXI,PIXI.filters,PIXI);
